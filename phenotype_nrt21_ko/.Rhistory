filter(type%in%c("ATP_biosynthesis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_ATP_biosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_ATP_biosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_ATP_biosynthesis <- inner_join(Rcor_NRT2.1_genes_ATP_biosynthesis, Pcor_NRT2.1_genes_ATP_biosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Photosynthesis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Photosynthesis <- inner_join(Rcor_NRT2.1_genes_Photosynthesis, Pcor_NRT2.1_genes_Photosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("TCAcycle_mitocondrialET","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_TCAcycle_mitocondrialET <- inner_join(Rcor_NRT2.1_genes_TCAcycle_mitocondrialET, Pcor_NRT2.1_genes_TCAcycle_mitocondrialET, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Tetrapyrrole","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Tetrapyrrole <- inner_join(Rcor_NRT2.1_genes_Tetrapyrrole, Pcor_NRT2.1_genes_Tetrapyrrole, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
genes_Nnutrition <- read_tsv("SC18_data/Genes_interest.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition <- inner_join(CPM_SC18_all_WT_Zscore, genes_Nnutrition, by="gene") %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
mutate(type="Nnutrition")
Pcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Nnutrition <- inner_join(Rcor_NRT2.1_genes_Nnutrition, Pcor_NRT2.1_genes_Nnutrition, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
cell_wall <- read_tsv("SC18_data/genes_cell_wall_Hartasanchez.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_cellWall <- inner_join(CPM_SC18_all_WT_Zscore, cell_wall, by="gene") %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_cellWall <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_cellWall, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_cellWall$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(cell_wall, by="gene")
Pcor_NRT2.1_genes_cellWall <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_cellWall, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_cellWall$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_cellWall <- inner_join(Rcor_NRT2.1_genes_cellWall, Pcor_NRT2.1_genes_cellWall, by="gene") %>%
filter(gene!="AT1G08090") %>%
drop_na()
Corr_NRT2.1_genes_all_groups <- bind_rows(Corr_NRT2.1_genes_Glycolysis, Corr_NRT2.1_genes_Asp_family_pathway, Corr_NRT2.1_genes_ATP_biosynthesis, Corr_NRT2.1_genes_Photosynthesis,Corr_NRT2.1_genes_TCAcycle_mitocondrialET, Corr_NRT2.1_genes_Tetrapyrrole, Corr_NRT2.1_genes_Nnutrition, Corr_NRT2.1_genes_cellWall) %>%
mutate(Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05"))
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "cell_wall", "Asp_family_pathway", "TCAcycle_mitocondrialET",
"ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point(size=3, alpha=0.6) +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.key = element_rect(fill = NA, color = NA))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "cell_wall", "Asp_family_pathway", "TCAcycle_mitocondrialET",
"ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point(size=3, alpha=0.6) +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.key = element_rect(fill = NA, color = NA), legend.position="bottom")
Corr_NRT2.1_genes_all_groups <- bind_rows(Corr_NRT2.1_genes_Glycolysis, Corr_NRT2.1_genes_Asp_family_pathway, Corr_NRT2.1_genes_ATP_biosynthesis, Corr_NRT2.1_genes_Photosynthesis,Corr_NRT2.1_genes_TCAcycle_mitocondrialET, Corr_NRT2.1_genes_Tetrapyrrole, Corr_NRT2.1_genes_Nnutrition, Corr_NRT2.1_genes_cellWall) %>%
mutate(Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05"))
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "cell_wall", "Asp_family_pathway", "TCAcycle_mitocondrialET",
"ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point(size=3, alpha=0.6) +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.key = element_rect(fill = NA, color = NA), legend.position="bottom")
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
Corr_NRT2.1_genes_all_groups <- bind_rows(Corr_NRT2.1_genes_Glycolysis, Corr_NRT2.1_genes_Asp_family_pathway, Corr_NRT2.1_genes_ATP_biosynthesis, Corr_NRT2.1_genes_Photosynthesis,Corr_NRT2.1_genes_TCAcycle_mitocondrialET, Corr_NRT2.1_genes_Tetrapyrrole, Corr_NRT2.1_genes_Nnutrition, Corr_NRT2.1_genes_cellWall) %>%
mutate(Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05"))
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "cell_wall", "Asp_family_pathway", "TCAcycle_mitocondrialET",
"ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point(size=3, alpha=0.6) +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.key = element_rect(fill = NA, color = NA), legend.position="bottom")
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=9)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
SC67 <- read_tsv("SC67_WT_nrt21_1mM_10mM/SC67_root_measure.txt") %>%
mutate(root_length_mm=length_px/scale_px_mm,
KNO3= factor(KNO3, levels=c("1mM", "10mM")),
LRD=lateralRoots/root_length_mm) %>%
mutate(rep="replicate 1")
SC68 <- read_tsv("SC68_WT_nrt21_1mM_10mM/SC68_root_measurement.txt") %>%
mutate(root_length_mm=length_px/scale_px_mm,
KNO3= factor(KNO3, levels=c("1mM", "10mM")),
LRD=lateralRoots/root_length_mm) %>%
mutate(rep="replicate 2")
SC69 <- read_tsv("SC69_WT_nrt21_1mM_10mM/SC69_root_measurement.txt") %>%
mutate(root_length_mm=length_px/scale_px_mm,
KNO3= factor(KNO3, levels=c("1mM", "10mM")),
LRD=lateralRoots/root_length_mm) %>%
mutate(rep="replicate 3")
All_reps_WT_nrt21 <- bind_rows(SC67, SC68, SC69)
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
ggplot( aes(x=rep, y=root_length_mm, col=genotype))+
geom_boxplot() +
geom_jitter(position = position_jitterdodge(jitter.width = 0.2, jitter.height = 0, dodge.width = 0.75)) +
facet_wrap(~KNO3) +
stat_compare_means(size=4, label="p.format", method="wilcox") +
scale_color_brewer(palette="Set2", name="", labels=c("Col0_WT"="Col0 WT", "nrt2.1_KO"=expression(italic("nrt2.1")))) +
ylab("Primary root length (mm) \n") +
xlab("")+
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),strip.text.x = element_text(size = 12),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.position="bottom", legend.key = element_rect(fill = NA, color = NA))
colors_brewer <- brewer.pal(n = 9, name = "Greys")[c(5,7,9)]
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
ggplot( aes(x=genotype, y=root_length_mm, col= rep ))+
geom_boxplot() +
geom_jitter(position = position_jitterdodge(jitter.width = 0.2, jitter.height = 0, dodge.width = 0.75)) +
facet_wrap(~KNO3) +
stat_compare_means(size=4, label="p.format", method="anova") +
scale_color_manual(values=colors_brewer) +
ylab("Primary root length (mm) \n") +
xlab("")+
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),strip.text.x = element_text(size = 12),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.position="bottom", legend.key = element_rect(fill = NA, color = NA))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3"))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE)
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep, str_remove("replicate "))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep, str_remove("replicate ",genotype_rep))
?str_remove
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep, str_remove(genotype_rep,"replicate "))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep, str_remove(genotype_rep,"replicate"))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep, str_replace(genotype_rep,"replicate", "rep"))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep, str_replace(genotype_rep,"replicate", "rep"))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep, str_replace(genotype_rep,"_replicate ", "_rep"))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep"))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep, levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3")))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3"))) %>%
ggplot( aes(x=genotype_rep, y=root_length_mm))+
geom_boxplot() +
geom_jitter(position = position_jitterdodge(jitter.width = 0.2, jitter.height = 0, dodge.width = 0.75)) +
facet_wrap(~KNO3)
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3"))) %>%
ggplot( aes(x=genotype_rep, y=root_length_mm))+
geom_boxplot()
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3"))) %>%
ggplot( aes(x=genotype_rep, y=root_length_mm))+
geom_boxplot() +
geom_jitter()
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3"))) %>%
ggplot( aes(x=genotype_rep, y=root_length_mm))+
geom_boxplot() +
geom_jitter(position = position_jitterdodge(jitter.width = 0.2, jitter.height = 0))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3"))) %>%
ggplot( aes(x=genotype_rep, y=root_length_mm))+
geom_boxplot() +
geom_jitter(position = position_jitter(jitter.width = 0.2, jitter.height = 0))
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3"))) %>%
ggplot( aes(x=genotype_rep, y=root_length_mm))+
geom_boxplot() +
geom_jitter(width = 0.2, height = 0)
mutate(All_reps_WT_nrt21, KNO3 = paste(KNO3, "KNO3")) %>%
mutate(KNO3=factor(KNO3, levels=c("1mM KNO3", "10mM KNO3"))) %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3"))) %>%
ggplot( aes(x=genotype_rep, y=root_length_mm))+
geom_boxplot() +
geom_jitter(width = 0.2, height = 0) +
facet_wrap(~KNO3)
filter(All_reps_WT_nrt21, KNO3 == "1mM KNO3") %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3"))) %>%
ggplot( aes(x=genotype_rep, y=root_length_mm))+
geom_boxplot() +
geom_jitter(width = 0.2, height = 0)
filter(All_reps_WT_nrt21, KNO3 == "1mM") %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3"))) %>%
ggplot( aes(x=genotype_rep, y=root_length_mm))+
geom_boxplot() +
geom_jitter(width = 0.2, height = 0)
library(multcompView)
tri.to.squ<-function(x)
{
rn<-row.names(x)
cn<-colnames(x)
an<-unique(c(cn,rn))
myval<-x[!is.na(x)]
mymat<-matrix(1,nrow=length(an),ncol=length(an),dimnames=list(an,an))
for(ext in 1:length(cn))
{
for(int in 1:length(rn))
{
if(is.na(x[row.names(x)==rn[int],colnames(x)==cn[ext]])) next
mymat[row.names(mymat)==rn[int],colnames(mymat)==cn[ext]]<-x[row.names(x)==rn[int],colnames(x)==cn[ext]]
mymat[row.names(mymat)==cn[ext],colnames(mymat)==rn[int]]<-x[row.names(x)==rn[int],colnames(x)==cn[ext]]
}
}
return(mymat)
}
first.set<-cbind(rnorm(100,mean=1.8),1)
second.set<-cbind(rnorm(100,mean=0.9),2)
third.set<-cbind(rnorm(100,mean=1),3)
full<-rbind(first.set,second.set,third.set)
full
Data_1mM <- filter(All_reps_WT_nrt21, KNO3 == "1mM") %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
"nrt2.1_KO_rep1", "nrt2.1_KO_rep2", "nrt2.1_KO_rep3")))
Data_1mM
pp<-pairwise.wilcox.test(Data_1mM$root_length_mm, Data_1mM$genotype_rep, p.adjust.method = "none", paired = FALSE)
pp
mymat<-tri.to.squ(pp$p.value)
mymat
myletters<-multcompLetters(mymat,compare="<=",threshold=0.05,Letters=letters)
myletters
boxplot(Data_1mM$root_length_mm ~ Data_1mM$genotype_rep)
text(c(1,2,3),0.2+max(Data_1mM$root_length_mm),c(myletters$Letters[1],myletters$Letters[2],myletters$Letters[3]))
text(c(1,2,3),0.2+max(Data_1mM$root_length_mm),c(myletters$Letters[1],myletters$Letters[2],myletters$Letters[3],
myletters$Letters[4],myletters$Letters[5],myletters$Letters[6]))
boxplot(Data_1mM$root_length_mm ~ Data_1mM$genotype_rep)
text(c(1,2,3),0.2+max(Data_1mM$root_length_mm),c(myletters$Letters[1],myletters$Letters[2],myletters$Letters[3],
myletters$Letters[4],myletters$Letters[5],myletters$Letters[6]))
boxplot(Data_1mM$root_length_mm ~ Data_1mM$genotype_rep)
text(c(1,2,3,4,5,6),0.2+max(Data_1mM$root_length_mm),c(myletters$Letters[1],myletters$Letters[2],myletters$Letters[3],
myletters$Letters[4],myletters$Letters[5],myletters$Letters[6]))
boxplot(Data_1mM$root_length_mm ~ Data_1mM$genotype_rep)
text(c(1,2,3,4,5,6),0.2+max(Data_1mM$root_length_mm),c(myletters$Letters[1],myletters$Letters[2],myletters$Letters[3],
myletters$Letters[4],myletters$Letters[5],myletters$Letters[6]),
size=10)
knitr::opts_chunk$set(echo = TRUE)
Lumalum_17Feb202part1 <- read_tsv("17au26fev2025_Part1/lumalum_17Feb2025_part1.txt")
Lumalum_17Feb202part1_norm <- mutate(Lumalum_17Feb202part1, RawIntDenDivArea=RawIntDen/Area) %>%
filter(seedling=="background") %>%
group_by(Position, Slice) %>%
summarise(MeanBack=mean(RawIntDenDivArea)) %>%
full_join(Lumalum_17Feb202part1, by=c("Position"="Position", "Slice"="Slice")) %>%
mutate(RawIntDen_NormBack= RawIntDen-(MeanBack*Area)) %>%
mutate(root_length_mm= length/3.2,
RawIntDen_NormBack_NormLen=RawIntDen_NormBack/root_length_mm) %>%
filter(seedling!="background")
"Col0_WT_rep1", "Col0_WT_rep2", "Col0_WT_rep3",
Data_1mM <- filter(All_reps_WT_nrt21, KNO3 == "1mM") %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "nrt2.1_KO_rep1", "Col0_WT_rep2","nrt2.1_KO_rep2",
"Col0_WT_rep3","nrt2.1_KO_rep3")))
pp<-pairwise.wilcox.test(Data_1mM$root_length_mm, Data_1mM$genotype_rep, p.adjust.method = "none", paired = FALSE)
mymat<-tri.to.squ(pp$p.value)
myletters<-multcompLetters(mymat,compare="<=",threshold=0.05,Letters=letters)
boxplot(Data_1mM$root_length_mm ~ Data_1mM$genotype_rep)
text(c(1,2,3,4,5,6),0.2+max(Data_1mM$root_length_mm),c(myletters$Letters[1],myletters$Letters[2],myletters$Letters[3],
)
)
Data_1mM <- filter(All_reps_WT_nrt21, KNO3 == "1mM") %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "nrt2.1_KO_rep1", "Col0_WT_rep2","nrt2.1_KO_rep2",
"Col0_WT_rep3","nrt2.1_KO_rep3")))
pp<-pairwise.wilcox.test(Data_1mM$root_length_mm, Data_1mM$genotype_rep, p.adjust.method = "none", paired = FALSE)
mymat<-tri.to.squ(pp$p.value)
myletters<-multcompLetters(mymat,compare="<=",threshold=0.05,Letters=letters)
boxplot(Data_1mM$root_length_mm ~ Data_1mM$genotype_rep)
text(c(1,2,3,4,5,6),0.2+max(Data_1mM$root_length_mm),c(myletters$Letters[1],myletters$Letters[2],myletters$Letters[3],
myletters$Letters[4],myletters$Letters[5],myletters$Letters[6]))
Data_10mM <- filter(All_reps_WT_nrt21, KNO3 == "10mM") %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "nrt2.1_KO_rep1", "Col0_WT_rep2","nrt2.1_KO_rep2",
"Col0_WT_rep3","nrt2.1_KO_rep3")))
pp10<-pairwise.wilcox.test(Data_10mM$root_length_mm, Data_10mM$genotype_rep, p.adjust.method = "none", paired = FALSE)
mymat10<-tri.to.squ(pp10$p.value)
myletters10<-multcompLetters(mymat10,compare="<=",threshold=0.05,Letters=letters)
boxplot(Data_10mM$root_length_mm ~ Data_10mM$genotype_rep)
text(c(1,2,3,4,5,6),0.2+max(Data_10mM$root_length_mm),c(myletters10$Letters[1],myletters10$Letters[2],
myletters10$Letters[3],myletters10$Letters[4],
myletters10$Letters[5],myletters10$Letters[6]))
Data_10mM <- filter(All_reps_WT_nrt21, KNO3 == "10mM") %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "nrt2.1_KO_rep1", "Col0_WT_rep2","nrt2.1_KO_rep2",
"Col0_WT_rep3","nrt2.1_KO_rep3")))
pp10<-pairwise.wilcox.test(Data_10mM$LRD, Data_10mM$genotype_rep, p.adjust.method = "none", paired = FALSE)
mymat10<-tri.to.squ(pp10$p.value)
myletters10<-multcompLetters(mymat10,compare="<=",threshold=0.05,Letters=letters)
boxplot(Data_10mM$LRD ~ Data_10mM$genotype_rep)
text(c(1,2,3,4,5,6),0.2+max(Data_10mM$LRD),c(myletters10$Letters[1],myletters10$Letters[2],
myletters10$Letters[3],myletters10$Letters[4],
myletters10$Letters[5],myletters10$Letters[6]))
pp10
mymat10
myletters10
boxplot(Data_10mM$LRD ~ Data_10mM$genotype_rep)
text(c(1,2,3,4,5,6),0.2+max(Data_10mM$LRD),c(myletters10$Letters[1],myletters10$Letters[2],
myletters10$Letters[3],myletters10$Letters[4],
myletters10$Letters[5],myletters10$Letters[6]))
boxplot(Data_10mM$LRD ~ Data_10mM$genotype_rep)
text(c(1,2,3,4,5,6),0.02+max(Data_10mM$LRD),c(myletters10$Letters[1],myletters10$Letters[2],
myletters10$Letters[3],myletters10$Letters[4],
myletters10$Letters[5],myletters10$Letters[6]))
boxplot(Data_10mM$LRD ~ Data_10mM$genotype_rep)
text(c(1,2,3,4,5,6),0.002+max(Data_10mM$LRD),c(myletters10$Letters[1],myletters10$Letters[2],
myletters10$Letters[3],myletters10$Letters[4],
myletters10$Letters[5],myletters10$Letters[6]))
Data_1mM <- filter(All_reps_WT_nrt21, KNO3 == "1mM") %>%
unite(genotype, rep, col="genotype_rep", remove = FALSE) %>%
mutate(genotype_rep=str_replace(genotype_rep,"_replicate ", "_rep")) %>%
mutate(genotype_rep=factor(genotype_rep,
levels=c("Col0_WT_rep1", "nrt2.1_KO_rep1", "Col0_WT_rep2","nrt2.1_KO_rep2",
"Col0_WT_rep3","nrt2.1_KO_rep3")))
pp<-pairwise.wilcox.test(Data_1mM$LRD, Data_1mM$genotype_rep, p.adjust.method = "none", paired = FALSE)
mymat<-tri.to.squ(pp$p.value)
myletters<-multcompLetters(mymat,compare="<=",threshold=0.05,Letters=letters)
boxplot(Data_1mM$LRD ~ Data_1mM$genotype_rep)
text(c(1,2,3,4,5,6),0.002+max(Data_1mM$LRD),c(myletters$Letters[1],myletters$Letters[2],myletters$Letters[3],
myletters$Letters[4],myletters$Letters[5],myletters$Letters[6]))
