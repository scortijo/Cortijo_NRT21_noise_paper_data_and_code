xlim(800, 3600)+
ylab(expression(paste(italic("NRT2.1:LUC")," signal of offsprings"))) +
xlab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
scale_shape(name="Type of parent")
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other",
!Parent_name%in%c("line39", "line54")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
scale_color_brewer(palette = "Paired", name="Line") +
scale_shape(name="Type of parent") +
xlab("") +
scale_color_manual(values=parents_col, name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other",
!Parent_name%in%c("line39", "line54"))
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other",
!Parent_name%in%c("line39", "line54")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")))
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other",
!Parent_name%in%c("line39", "line54")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_point(size=3)
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other",
!Parent_name%in%c("line39", "line54")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
scale_color_brewer(palette = "Paired", name="Line") +
scale_shape(name="Type of parent") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other",
!Parent_name%in%c("line39", "line54")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
scale_color_brewer(palette = "Paired", name="Line",  labels=c("1", "2", "3", "4", "5",
"6", "7", "8", "9", "10")) +
scale_shape(name="Type of parent") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other",
!Parent_name%in%c("line39", "line54")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
scale_color_brewer(palette = "Paired", name="Line",  labels=c("1", "2", "3", "4", "5",
"6", "7", "8", "9", "10")) +
scale_shape(name="Type of parent") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50")) +
guides(shape = guide_legend(order=1),
color = guide_legend(order=2))
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other",
!Parent_name%in%c("line39", "line54")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
scale_color_brewer(palette = "Paired", name="Line",  labels=c("1", "2", "3", "4", "5",
"6", "7", "8", "9", "10")) +
scale_shape(name="Type of parent") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50")) +
guides(shape = guide_legend(order=1),
color = guide_legend(order=2))
ggsave("Selection_parents_rep2_transGen.jpg",height = 5, width = 5)
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other",
!Parent_name%in%c("line39", "line54")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
scale_color_brewer(palette = "Paired", name="Line",  labels=c("1", "2", "3", "4", "5",
"6", "7", "8", "9", "10")) +
scale_shape(name="Type of parent") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))  +
guides(shape = guide_legend(order=1),
color = guide_legend(order=2))
ggsave("Selection_parents_rep2_transGen.jpg",height = 5, width = 5)
#rep1
MO1 <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/MO1_transgenerational/Mo_01_20230418.txt")
MO2 <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/MO2_transgenerational/Mo_02_20230424.txt")
MO3 <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/MO3_transgenerational/Mo_03_20230512.txt")
rep1 <- bind_rows(MO1,MO2 ,MO3) %>%
mutate(expt="rep1")
#rep2
SC48 <- read_tsv("rep2_SC48_SC49_transgenerational/SC48_transgenerational/SC48_TransGen_luc_signal.txt")
SC49 <- read_tsv("rep2_SC48_SC49_transgenerational/SC49_transgenerational/SC49_transGenerational_luc_signal.txt")
rep2 <- bind_rows(SC48,SC49 ) %>%
mutate(expt="rep2")
rep1_2 <- rbind(rep1,rep2)
rep1_2_norm <- mutate(rep1_2, RawIntDenDivArea=RawIntDen/area) %>%
filter(seedling=="background") %>%
group_by(genotype, plate, expt) %>%
summarise(MeanBack=mean(RawIntDenDivArea)) %>%
full_join(rep1_2, by=c("genotype"="genotype", "plate"="plate", "expt"="expt")) %>%
mutate(RawIntDen_NormBack= RawIntDen-(MeanBack*area)) %>%
mutate(root_length_mm= length/4,
RawIntDen_NormBack_NormLen=RawIntDen_NormBack/root_length_mm) %>%
filter(seedling!="background")
rep1_parents <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/Rep1_parents_transgenerational_selection/Rep1_parents_transgenerational_selection.txt") %>%
mutate(expt="rep1")
rep2_parents <- read_tsv("rep2_SC48_SC49_transgenerational/Rep2_parents_transgenerational_selection/Rep2_parents_transgenerational_selection.txt") %>%
mutate(expt="rep2")
rep1_2_parents <- rbind(rep1_parents,rep2_parents)
# Normalisation of signal by the background and root length
rep1_2_parents_norm <- mutate(rep1_2_parents, RawIntDenDivArea_Parent=RawIntDen_Parent/area_Parent) %>%
filter(seedling_Parent=="background") %>%
group_by(genotype_Parent, PLATE_Parent, expt) %>%
summarise(MeanBack_Parent=mean(RawIntDenDivArea_Parent)) %>%
full_join(rep1_2_parents, by=c("genotype_Parent"="genotype_Parent", "PLATE_Parent"="PLATE_Parent", "expt"="expt")) %>%
mutate(RawIntDen_NormBack_Parent= RawIntDen_Parent-(MeanBack_Parent*area_Parent)) %>%
mutate(root_length_mm_Parent= length_Parent/4,
RawIntDen_NormBack_NormLen_Parent=RawIntDen_NormBack_Parent/root_length_mm_Parent) %>%
filter(seedling_Parent!="background")
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
big_plate <- read_tsv("AV_44_big_plates/20240902_AV_44_vari_big_plates.txt")
filter(big_plate, KNO3=="1mM" & seedling!="background" & DAY!=7 ,!seedling%in%c("seedling16", "seedling19", "seedling5", "seedling6")) %>%
mutate(DAY=factor(DAY, levels=c("10", "14", "17", "21"))) %>%
ggplot( aes(x=DAY, y=RawIntDen_normBackg_normLen, group=seedling)) +
geom_line( size=1) +
facet_wrap(~PLATE) +
xlab("Age of plants (days)") +
ylab(expression(paste("Luciferase signal for ", italic("NRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.position = "none",  strip.text.x = element_blank())
ggsave("Big_plates_10to21days_PR.jpg", height = 4, width=5.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(paste(italic("NRT2.1:LUC")," luciferase signal in 10 days old seedlings"))) +
ylab(expression(paste(italic("NRT2.1:LUC")," luciferase signal in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 6, width=6.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 10 days old seedlings"))) +
ylab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 6, width=6.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 10 days old seedlings"))) +
ylab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 6, width=6.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 10 days old seedlings"))) +
ylab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 5, width=5.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 10 days old seedlings"))) +
ylab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 5, width=5.5)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
T0 <- read_tsv("AV30_Effect_transfer/20230724_AV_30_T0_6J/20230724_AV_30_T0_6J.txt")
T1 <- read_tsv("AV30_Effect_transfer/20230725_AV_30_T1_7J/20230724_AV_30_T1_7J.txt")
T2 <- read_tsv("AV30_Effect_transfer/20230726_AV_30_T2_8J/20230726_AV_30_T2_8J.txt")
T3 <- read_tsv("AV30_Effect_transfer/20230727_AV_30_T3_9J/20230727_AV_30_T3_9J.txt")
T4 <- read_tsv("AV30_Effect_transfer/20230728_AV_30_T4_10J/20230727_AV_30_T4_10J.txt")
All_time_points_luc <- bind_rows(T0, T1, T2, T3, T4)
All_time_points_luc_norm <- mutate(All_time_points_luc, RawIntDenDivArea=RawIntDen/area) %>%
filter(seedling=="background") %>%
group_by( KNO3, PLATE, DAY) %>%
summarise(MeanBack=mean(RawIntDenDivArea)) %>%
full_join(All_time_points_luc, by=c("KNO3"="KNO3", "PLATE"="PLATE", "DAY"="DAY")) %>%
mutate(RawIntDen_NormBack= RawIntDen-(MeanBack*area)) %>%
mutate(root_length_mm= length/4,
RawIntDen_NormBack_NormLen=RawIntDen_NormBack/root_length_mm) %>%
filter(seedling!="background")
filter(All_time_points_luc_norm, PLATE%in%c("plate5", "plate6"),
!seedling%in%c("seedling33", "seedling36", "seedling37", "seedling44","seedling47")) %>%
mutate(days=as.numeric(str_replace(DAY, "T", "")),
days= days+6,
PLATE=factor(PLATE, levels=c("plate6", "plate5"))) %>%
ggplot( aes(x=days, y=RawIntDen_NormBack_NormLen, group=seedling)) +
geom_line( size=1) +
geom_vline(xintercept=6.3, col="blue", linetype="dashed") +
facet_wrap(~PLATE) +
xlab("Age of plants (days)") +
ylab(expression(paste("Luciferase signal for ", italic("NRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.position = "none")
ggsave("Signal_seedlings_after_transfer.jpg", height = 4, width=5.5)
select(All_time_points_luc_norm, "KNO3", "PLATE", "DAY", "seedling", "RawIntDen_NormBack_NormLen" ) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_NormBack_NormLen") %>%
ggplot(aes(x=T0, y=T4)) +
geom_point()+
xlab("Luciferase signal before transfer") +
ylab("luciferase signal after transfer") +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_before_after_first_transfer.jpg", height = 4.5, width=5)
select(All_time_points_luc_norm, "KNO3", "PLATE", "DAY", "seedling", "RawIntDen_NormBack_NormLen" ) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_NormBack_NormLen") %>%
ggplot(aes(x=T0, y=T4)) +
geom_point()+
xlab("Luciferase signal before transfer") +
ylab("luciferase signal after transfer") +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_before_after_first_transfer.jpg", height = 4, width=4.5)
select(All_time_points_luc_norm, "KNO3", "PLATE", "DAY", "seedling", "RawIntDen_NormBack_NormLen" ) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_NormBack_NormLen") %>%
ggplot(aes(x=T0, y=T4)) +
geom_point()+
xlab("Luciferase signal before transfer") +
ylab("luciferase signal after transfer") +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_before_after_first_transfer.jpg", height = 4.5, width=5)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
gene_types <- read_tsv("SC18_data/Genes_interest.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
options(scipen=999)
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, -nitrate_response_nlp7_compared_wt) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(targets_NLP7, by=c("gene"="AGI"))
Pcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_nlp7 <- inner_join(Rcor_NRT2.1_genes_nlp7, Pcor_NRT2.1_genes_nlp7, by="gene") %>%
filter(gene!="AT1G08090")
## Ribbon for NLP7 targets
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_long_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
CPM_SC18_all_WT_Zscore_long_NRT21 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene=="AT1G08090") %>%
mutate(seedling=fct_reorder(seedling, Zscore_normalised_expression))
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene!="AT1G08090")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle(expression(paste("Genes regulated by ", italic("NLP7")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Expression_nlp7Targets_smooth_NRT2.1.jpg", width=5, height = 5)
## Ribbon for NLP7 targets
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_long_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
CPM_SC18_all_WT_Zscore_long_NRT21 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene=="AT1G08090") %>%
mutate(seedling=fct_reorder(seedling, Zscore_normalised_expression))
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene!="AT1G08090")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle(expression(paste("Genes regulated by ", italic("NLP7")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Expression_nlp7Targets_smooth_NRT2.1.jpg", width=4.5, height = 4.5)
## Ribbon for NLP7 targets
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_long_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
CPM_SC18_all_WT_Zscore_long_NRT21 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene=="AT1G08090") %>%
mutate(seedling=fct_reorder(seedling, Zscore_normalised_expression))
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene!="AT1G08090")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle(expression(paste("Genes regulated by ", italic("NLP7")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=21),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Expression_nlp7Targets_smooth_NRT2.1.jpg", width=4, height = 4)
