ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 5)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
big_plate <- read_tsv("AV_44_big_plates/20240902_AV_44_vari_big_plates.txt")
filter(big_plate, KNO3=="1mM" & seedling!="background" & DAY!=7 ,!seedling%in%c("seedling16", "seedling19", "seedling5", "seedling6")) %>%
mutate(DAY=factor(DAY, levels=c("10", "14", "17", "21"))) %>%
ggplot( aes(x=DAY, y=RawIntDen_normBackg_normLen, group=seedling)) +
geom_line( size=1) +
facet_wrap(~PLATE) +
xlab("Age of plants (days)") +
ylab(expression(paste("Luciferase signal for ", italic("NRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.position = "none",  strip.text.x = element_blank())
ggsave("Big_plates_10to21days_PR.jpg", height = 4, width=5.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(paste(italic("NRT2.1:LUC")," luciferase signal in 10 days old seedlings"))) +
ylab(expression(paste(italic("NRT2.1:LUC")," luciferase signal in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 6, width=6.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 10 days old seedlings"))) +
ylab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 6, width=6.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 10 days old seedlings"))) +
ylab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 6, width=6.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 10 days old seedlings"))) +
ylab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 5, width=5.5)
select(big_plate, KNO3, PLATE, DAY, seedling, RawIntDen_normBackg_normLen ) %>%
filter(KNO3=="1mM" & seedling!="background") %>%
mutate(DAY=paste("T", DAY, sep="")) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_normBackg_normLen") %>%
ggplot(aes(x=T10, y=T21)) +
geom_point()+
xlab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 10 days old seedlings"))) +
ylab(expression(atop(paste(italic("NRT2.1:LUC")," luciferase signal"), "in 21 days old seedlings"))) +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_big_plates_10dVS21d_PR.jpg", height = 5, width=5.5)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
T0 <- read_tsv("AV30_Effect_transfer/20230724_AV_30_T0_6J/20230724_AV_30_T0_6J.txt")
T1 <- read_tsv("AV30_Effect_transfer/20230725_AV_30_T1_7J/20230724_AV_30_T1_7J.txt")
T2 <- read_tsv("AV30_Effect_transfer/20230726_AV_30_T2_8J/20230726_AV_30_T2_8J.txt")
T3 <- read_tsv("AV30_Effect_transfer/20230727_AV_30_T3_9J/20230727_AV_30_T3_9J.txt")
T4 <- read_tsv("AV30_Effect_transfer/20230728_AV_30_T4_10J/20230727_AV_30_T4_10J.txt")
All_time_points_luc <- bind_rows(T0, T1, T2, T3, T4)
All_time_points_luc_norm <- mutate(All_time_points_luc, RawIntDenDivArea=RawIntDen/area) %>%
filter(seedling=="background") %>%
group_by( KNO3, PLATE, DAY) %>%
summarise(MeanBack=mean(RawIntDenDivArea)) %>%
full_join(All_time_points_luc, by=c("KNO3"="KNO3", "PLATE"="PLATE", "DAY"="DAY")) %>%
mutate(RawIntDen_NormBack= RawIntDen-(MeanBack*area)) %>%
mutate(root_length_mm= length/4,
RawIntDen_NormBack_NormLen=RawIntDen_NormBack/root_length_mm) %>%
filter(seedling!="background")
filter(All_time_points_luc_norm, PLATE%in%c("plate5", "plate6"),
!seedling%in%c("seedling33", "seedling36", "seedling37", "seedling44","seedling47")) %>%
mutate(days=as.numeric(str_replace(DAY, "T", "")),
days= days+6,
PLATE=factor(PLATE, levels=c("plate6", "plate5"))) %>%
ggplot( aes(x=days, y=RawIntDen_NormBack_NormLen, group=seedling)) +
geom_line( size=1) +
geom_vline(xintercept=6.3, col="blue", linetype="dashed") +
facet_wrap(~PLATE) +
xlab("Age of plants (days)") +
ylab(expression(paste("Luciferase signal for ", italic("NRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"), legend.position = "none")
ggsave("Signal_seedlings_after_transfer.jpg", height = 4, width=5.5)
select(All_time_points_luc_norm, "KNO3", "PLATE", "DAY", "seedling", "RawIntDen_NormBack_NormLen" ) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_NormBack_NormLen") %>%
ggplot(aes(x=T0, y=T4)) +
geom_point()+
xlab("Luciferase signal before transfer") +
ylab("luciferase signal after transfer") +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_before_after_first_transfer.jpg", height = 4.5, width=5)
select(All_time_points_luc_norm, "KNO3", "PLATE", "DAY", "seedling", "RawIntDen_NormBack_NormLen" ) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_NormBack_NormLen") %>%
ggplot(aes(x=T0, y=T4)) +
geom_point()+
xlab("Luciferase signal before transfer") +
ylab("luciferase signal after transfer") +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_before_after_first_transfer.jpg", height = 4, width=4.5)
select(All_time_points_luc_norm, "KNO3", "PLATE", "DAY", "seedling", "RawIntDen_NormBack_NormLen" ) %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_NormBack_NormLen") %>%
ggplot(aes(x=T0, y=T4)) +
geom_point()+
xlab("Luciferase signal before transfer") +
ylab("luciferase signal after transfer") +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_before_after_first_transfer.jpg", height = 4.5, width=5)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
gene_types <- read_tsv("SC18_data/Genes_interest.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
options(scipen=999)
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, -nitrate_response_nlp7_compared_wt) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(targets_NLP7, by=c("gene"="AGI"))
Pcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_nlp7 <- inner_join(Rcor_NRT2.1_genes_nlp7, Pcor_NRT2.1_genes_nlp7, by="gene") %>%
filter(gene!="AT1G08090")
## Ribbon for NLP7 targets
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_long_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
CPM_SC18_all_WT_Zscore_long_NRT21 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene=="AT1G08090") %>%
mutate(seedling=fct_reorder(seedling, Zscore_normalised_expression))
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene!="AT1G08090")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle(expression(paste("Genes regulated by ", italic("NLP7")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Expression_nlp7Targets_smooth_NRT2.1.jpg", width=5, height = 5)
## Ribbon for NLP7 targets
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_long_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
CPM_SC18_all_WT_Zscore_long_NRT21 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene=="AT1G08090") %>%
mutate(seedling=fct_reorder(seedling, Zscore_normalised_expression))
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene!="AT1G08090")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle(expression(paste("Genes regulated by ", italic("NLP7")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=20),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Expression_nlp7Targets_smooth_NRT2.1.jpg", width=4.5, height = 4.5)
## Ribbon for NLP7 targets
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_long_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
CPM_SC18_all_WT_Zscore_long_NRT21 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene=="AT1G08090") %>%
mutate(seedling=fct_reorder(seedling, Zscore_normalised_expression))
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene!="AT1G08090")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle(expression(paste("Genes regulated by ", italic("NLP7")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=18),
plot.title = element_text(size=21),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Expression_nlp7Targets_smooth_NRT2.1.jpg", width=4, height = 4)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
AV01 <- read_tsv("compilation_pNRT21.LUC/AV01_luciferase/AV01_luciferase_measure.txt") %>%
mutate(expt="AV01")
AV05 <- read_tsv("compilation_pNRT21.LUC/AV05_luciferase/AV05_luciferase_measure.txt") %>%
mutate(expt="AV05")
AV07 <- read_tsv("compilation_pNRT21.LUC/AV07_luciferase/AV07_luciferase_measure.txt") %>%
mutate(expt="AV07")
AV08 <- read_tsv("compilation_pNRT21.LUC/AV08_luciferase/AV08_luciferase_measure.txt") %>%
mutate(expt="AV08")
AV12_rep1 <- read_tsv("compilation_pNRT21.LUC/AV12_luciferase_rep1/AV12_rep1_luciferase_measure.txt") %>%
mutate(expt="AV12_rep1")
AV12_rep2 <- read_tsv("compilation_pNRT21.LUC/AV12_luciferase_rep2/AV12_rep2_luciferase_measure.txt") %>%
mutate(expt="AV12_rep2")
AV12_rep3 <- read_tsv("compilation_pNRT21.LUC/AV12_luciferase_rep3/AV12_rep3_luciferase_measure.txt") %>%
mutate(expt="AV12_rep3")
AV13_rep2 <- read_tsv("compilation_pNRT21.LUC/AV13_luciferase_rep2/AV13_rep2_luciferase_measure.txt") %>%
mutate(expt="AV13_rep2")
AV13_rep2 <- read_tsv("compilation_pNRT21.LUC/AV13_luciferase_rep2/AV13_rep2_luciferase_measure.txt") %>%
mutate(expt="AV13_rep2")
AV13_rep3 <- read_tsv("compilation_pNRT21.LUC/AV13_luciferase_rep3/AV13_rep3_luciferase_measure.txt") %>%
mutate(expt="AV13_rep3")
AV13_rep4 <- read_tsv("compilation_pNRT21.LUC/AV13_luciferase_rep4/AV13_rep4_luciferase_measure.txt") %>%
mutate(expt="AV13_rep4")
AV14 <- read_tsv("compilation_pNRT21.LUC/AV14_luciferase/AV14_luciferase_measure.txt") %>%
mutate(expt="AV14")
AV15 <- read_tsv("compilation_pNRT21.LUC/AV15_luciferase/AV15_luciferase_measure.txt") %>%
mutate(expt="AV15")
AV16 <- read_tsv("compilation_pNRT21.LUC/AV16_luciferase/AV16_luciferase_measure.txt") %>%
mutate(expt="AV16")
AV18 <- read_tsv("compilation_pNRT21.LUC/AV18_luciferase/AV18_luciferase_measure.txt") %>%
mutate(expt="AV18")
AV19 <- read_tsv("compilation_pNRT21.LUC/AV19_luciferase/AV19_luciferase_measure.txt") %>%
mutate(expt="AV19")
AV26_rep1 <- read_tsv("compilation_pNRT21.LUC/AV26_luciferase_rep1/AV26_luciferase_measure.txt") %>%
mutate(expt="AV26_rep1")
AV26_rep2 <- read_tsv("compilation_pNRT21.LUC/AV26_luciferase_rep2/AV26_luciferase_measure_rep2.txt") %>%
mutate(expt="AV26_rep2")
AV26_rep3 <- read_tsv("compilation_pNRT21.LUC/AV26_luciferase_rep3/AV26_rep3_luciferase_measure.txt") %>%
mutate(expt="AV26_rep3")
AV26_rep5 <- read_tsv("compilation_pNRT21.LUC/AV26_luciferase_rep5/AV26_rep5_luciferase_measure.txt") %>%
mutate(expt="AV26_rep5")
AV28 <- read_tsv("compilation_pNRT21.LUC/AV28_luciferase/AV28_luciferase_measure.txt") %>%
mutate(expt="AV28")
SC13 <- read_tsv("compilation_pNRT21.LUC/SC13_luciferase/SC13_luciferase_measure.txt") %>%
mutate(expt="SC13")
SC15 <- read_tsv("compilation_pNRT21.LUC/SC15_luciferase/SC15_luciferase_measure.txt") %>%
mutate(expt="SC15")
SC21 <- read_tsv("compilation_pNRT21.LUC/SC21_luciferase/SC21_luciferase_measure.txt") %>%
mutate(expt="SC21")
All_reps_luc <- bind_rows(AV01, AV05, AV07, AV08, AV12_rep1, AV12_rep2, AV12_rep3, AV13_rep2, AV13_rep3, AV13_rep4, AV14, AV15, AV16,
AV18, AV19, AV26_rep1, AV26_rep2, AV26_rep3, AV26_rep5, AV28, SC13, SC15, SC21)
All_reps_luc_norm <- mutate(All_reps_luc, RawIntDenDivArea=RawIntDen/area) %>%
filter(seedling=="background") %>%
group_by(expt, KNO3, plate) %>%
summarise(MeanBack=mean(RawIntDenDivArea)) %>%
full_join(All_reps_luc, by=c("expt"="expt",  "KNO3"="KNO3", "plate"="plate")) %>%
mutate(RawIntDen_NormBack= RawIntDen-(MeanBack*area)) %>%
mutate(root_length_mm= length/4.95,
RawIntDen_NormBack_NormLen=RawIntDen_NormBack/root_length_mm) %>%
filter(seedling!="background")
All_reps_luc_norm
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=Ratio_1mM_10mM)) +
geom_density(size=1.2) +
geom_jitter(aes(y=0.1), width = 0, height = 0.05) +
xlim(0.8,2.5) +
ylab("Density") +
xlab("Ratio of signal at low/high \nnitrate concentration") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=factor(0),y=Ratio_1mM_10mM))+geom_boxplot() +
geom_hline(yintercept = 1, linetype="dashed", colour="grey") +
ylab("Ratio of signal at low/high nitrate concentration") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=factor(0),y=Ratio_1mM_10mM))+
geom_boxplot() +
geom_jitter(height = 0) +
geom_hline(yintercept = 1, linetype="dashed", colour="grey") +
ylab("Ratio of signal at low/high nitrate concentration") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=factor(0),y=Ratio_1mM_10mM))+
geom_boxplot() +
geom_jitter(height = 0, width = 0.2) +
geom_hline(yintercept = 1, linetype="dashed", colour="grey") +
ylab("Ratio of signal at low/high nitrate concentration") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=factor(0),y=Ratio_1mM_10mM))+
geom_boxplot() +
geom_jitter(height = 0, width = 0.1) +
geom_hline(yintercept = 1, linetype="dashed", colour="grey") +
ylab("Ratio of signal at low/high nitrate concentration") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=factor(0),y=Ratio_1mM_10mM))+
geom_boxplot() +
geom_jitter(height = 0, width = 0.01) +
geom_hline(yintercept = 1, linetype="dashed", colour="grey") +
ylab("Ratio of signal at low/high nitrate concentration") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=factor(0),y=Ratio_1mM_10mM))+
geom_boxplot() +
geom_jitter(height = 0, width = 0.02) +
geom_hline(yintercept = 1, linetype="dashed", colour="grey") +
ylab("Ratio of signal at low/high nitrate concentration") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=factor(0),y=Ratio_1mM_10mM))+
geom_boxplot() +
geom_jitter(height = 0, width = 0.015) +
geom_hline(yintercept = 1, linetype="dashed", colour="grey") +
ylab("Ratio of signal at low/high nitrate concentration") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
All_reps_luc_norm
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=Ratio_1mM_10mM)) +
geom_density(size=1.2) +
geom_jitter(aes(y=0.1), width = 0, height = 0.05) +
xlim(0.8,2.5) +
ylab("Density") +
xlab("Ratio of signal at low/high \nnitrate concentration") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
group_by(All_reps_luc_norm,expt, KNO3) %>%
summarise(MeanSignal=mean(RawIntDen_NormBack_NormLen)) %>%
pivot_wider(names_from = KNO3, values_from = MeanSignal) %>%
rename(Mean_10mM="10mM",Mean_1mM="1mM") %>%
mutate(Ratio_1mM_10mM = Mean_1mM/Mean_10mM) %>%
ggplot(aes(x=factor(0),y=Ratio_1mM_10mM))+
geom_boxplot() +
geom_jitter(height = 0, width = 0.02) +
geom_hline(yintercept = 1, linetype="dashed", colour="grey") +
ylab("Ratio of signal at low/high nitrate concentration") +
xlab("") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Distribution_ratio_signal_10mM_1mM.jpg", height = 6, width=5)
