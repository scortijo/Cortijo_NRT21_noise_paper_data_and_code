knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
# setwd("/Users/lecuyerc/Desktop/Stage_M1_LECUYER_Charlotte_2022/Luciferase_imaging/20220323_SC_13_9D") #  specifies the working directory of R
getwd() # check which directory you are in
luc <- read_tsv("../20220323_SC_13_9D/20220324_analyse.txt") %>% # Import data and load into the luc object, read_tsv allow to read file in txt form separated by tabulation
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM"))) # transform the KNO3 variable into a factor with different levels
luc <- read_tsv("../20220324_SC_13_9D/20220324_analyse.txt") %>% # Import data and load into the luc object, read_tsv allow to read file in txt form separated by tabulation
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM"))) # transform the KNO3 variable into a factor with different levels
names(luc) # gives the names of columns
luc_stats <- filter(luc, !is.na(genotype)) %>% # creates a new object without the data of background but we can also use : !number_seedling%in%c("background9","background10","background11")
group_by(genotype, KNO3)%>% # allows you to extract the descriptive statistics and display them in the graph with function summary
summarise(n=n(),
CV=sd(RawIntDen_norm_bckg,
na.rm = TRUE)/ mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>% # allows you to extract the number of observation and the coefficient of variation (=standard deviation)
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
luc <- read_tsv("../20220324_SC_13_9D/20220324_analyse.txt") %>% # Import data and load into the luc object, read_tsv allow to read file in txt form separated by tabulation
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM"))) # transform the KNO3 variable into a factor with different levels
names(luc) # gives the names of columns
luc_stats <- filter(luc, !is.na(genotype)) %>% # creates a new object without the data of background but we can also use : !number_seedling%in%c("background9","background10","background11")
group_by(genotype, KNO3)%>% # allows you to extract the descriptive statistics and display them in the graph with function summary
summarise(n=n(),
CV=sd(RawIntDen_norm_bckg,
na.rm = TRUE)/ mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>% # allows you to extract the number of observation and the coefficient of variation (=standard deviation)
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
luc <-mutate(luc, genotype=factor(genotype, levels=c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))) # transform the genotype variable into a factor with different levels
summary(luc$genotype) # shows the number of observations in each level
filter(luc, !is.na(genotype)) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>% # add the object luc_stats (with n and CV)
ggplot( aes(x=KNO3.x , y=RawIntDen_norm_bckg, col=genotype.x))+ # creates the plot with x and y axis
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(1.3),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 8000, position = position_dodge(1.3)) +
#   scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
#                 labels=c(expression(italic("pNRT2.1:LUC")),
#                          expression(italic("Arp6-1/pNRT2.1:LUC"))))+
#scale_color_manual(values = c("#00AFBB", "#CB2027"))+    -> find an other way to do that
geom_text(aes(label=n , x=KNO3.x, y=-10000 ),position=position_dodge(0.8)) + # shows the number of observation
geom_text(aes(label=CV , x=KNO3.x, y=600000 ),position=position_dodge(0.8)) + # shows the CV
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+ # allows you to modify the font size of each element and others elements of layout
xlab(expression(KNO[3]~concentration)) + # allows you to put numbers or others in subscript
ylab("Luciferase signal (Raw integrated density)") +
guides(col="none")
ggsave("RawIntDen_norm_back.jpg", width=10, height = 10)
All_meanForNorm <- filter(luc,!is.na(genotype)) %>%
group_by(genotype, KNO3)%>%
summarise(average.NormRawIntDen = mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE)
All_MeanNormalised <- filter(luc,!is.na(genotype)) %>%
unite(Sample, genotype, KNO3) %>%
full_join(., All_meanForNorm, by="Sample") %>%
mutate(MeanNormalised_RawIntDenSignal=log2(RawIntDen_norm_bckg/average.NormRawIntDen))
Stats_MeanNormalised <- group_by(All_MeanNormalised, genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_norm_bckg,
na.rm = TRUE)/ mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
All_MeanNormalised <-mutate(All_MeanNormalised, genotype=factor(genotype, levels=c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))) # transform the genotype variable into a factor with different levels
summary(luc$genotype) # shows the number of observations in each level
full_join(All_MeanNormalised,Stats_MeanNormalised, by="Sample") %>%
ggplot( aes(x=KNO3 , y=MeanNormalised_RawIntDenSignal, col=genotype))+
geom_boxplot(aes(color = genotype), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype, color = genotype), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.07, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("Arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=KNO3, y=-3 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3, y=3 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Mean normalised raw integrated density") +
guides(col="none")
ggsave("Mean_norm_data.jpg")
All_meanForNorm <- filter(luc,!is.na(genotype)) %>%
group_by(genotype, KNO3)%>%
summarise(average.NormRawIntDen_normLen = mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE)
All_MeanNormalised <- filter(luc,!is.na(genotype)) %>%
unite(Sample, genotype, KNO3) %>%
full_join(., All_meanForNorm, by="Sample") %>%
mutate(MeanNormalised_RawIntDenSignal=log2(RawIntDen_normBackg_normLen/average.NormRawIntDen_normLen))
Stats_MeanNormalised <- group_by(All_MeanNormalised, genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
All_MeanNormalised <-mutate(All_MeanNormalised, genotype=factor(genotype, levels=c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))) # transform the genotype variable into a factor with different levels
summary(luc$genotype) # shows the number of observations in each level
full_join(All_MeanNormalised,Stats_MeanNormalised, by="Sample") %>%
ggplot( aes(x=KNO3 , y=MeanNormalised_RawIntDenSignal, col=genotype))+
geom_boxplot(aes(color = genotype), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype, color = genotype), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.07, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("Arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=KNO3, y=-3 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3, y=3 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Mean normalised raw integrated density by background and length") +
guides(col="none")
ggsave("RawIntDen_normBackg_normLen.jpg")
View(All_meanForNorm)
View(All_MeanNormalised)
View(luc_stats)
View(Stats_MeanNormalised)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
# setwd("/Users/lecuyerc/Desktop/Stage_M1_LECUYER_Charlotte_2022/Luciferase_imaging/20220323_SC_13_9D") #  specifies the working directory of R
getwd() # check which directory you are in
luc <- read_tsv("../20220324_SC_13_9D/20220324_analyse.txt") %>% # Import data and load into the luc object, read_tsv allow to read file in txt form separated by tabulation
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM"))) # transform the KNO3 variable into a factor with different levels
names(luc) # gives the names of columns
luc_stats <- filter(luc, !is.na(genotype)) %>% # creates a new object without the data of background but we can also use : !number_seedling%in%c("background9","background10","background11")
group_by(genotype, KNO3)%>% # allows you to extract the descriptive statistics and display them in the graph with function summary
summarise(n=n(),
CV=sd(RawIntDen_norm_bckg,
na.rm = TRUE)/ mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>% # allows you to extract the number of observation and the coefficient of variation (=standard deviation)
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
All_meanForNorm <- filter(luc,!is.na(genotype)) %>%
group_by(genotype, KNO3)%>%
summarise(average.NormRawIntDen = mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE)
All_MeanNormalised <- filter(luc,!is.na(genotype)) %>%
unite(Sample, genotype, KNO3) %>%
full_join(., All_meanForNorm, by="Sample") %>%
mutate(MeanNormalised_RawIntDenSignal=log2(RawIntDen_norm_bckg/average.NormRawIntDen))
Stats_MeanNormalised <- group_by(All_MeanNormalised, genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_norm_bckg,
na.rm = TRUE)/ mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
All_MeanNormalised <-mutate(All_MeanNormalised, genotype=factor(genotype, levels=c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))) # transform the genotype variable into a factor with different levels
summary(luc$genotype) # shows the number of observations in each level
full_join(All_MeanNormalised,Stats_MeanNormalised, by="Sample") %>%
ggplot( aes(x=KNO3 , y=MeanNormalised_RawIntDenSignal, col=genotype))+
geom_boxplot(aes(color = genotype), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype, color = genotype), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.07, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("Arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=KNO3, y=-3 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3, y=3 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Mean normalised raw integrated density") +
guides(col="none")
ggsave("Mean_norm_data.jpg")
View(All_MeanNormalised)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
# setwd("/Users/lecuyerc/Desktop/Stage_M1_LECUYER_Charlotte_2022/Luciferase_imaging/20220323_SC_13_9D") #  specifies the working directory of R
getwd() # check which directory you are in
luc <- read_tsv("../20220324_SC_13_9D/20220324_SC_13_9D_analyse.txt") %>% # Import data and load into the luc object, read_tsv allow to read file in txt form separated by tabulation
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM"))) # transform the KNO3 variable into a factor with different levels
names(luc) # gives the names of columns
luc_stats <- filter(luc, !is.na(genotype)) %>% # creates a new object without the data of background but we can also use : !number_seedling%in%c("background9","background10","background11")
group_by(genotype, KNO3)%>% # allows you to extract the descriptive statistics and display them in the graph with function summary
summarise(n=n(),
CV=sd(RawIntDen_norm_bckg,
na.rm = TRUE)/ mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>% # allows you to extract the number of observation and the coefficient of variation (=standard deviation)
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
luc <-mutate(luc, genotype=factor(genotype, levels=c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))) # transform the genotype variable into a factor with different levels
summary(luc$genotype) # shows the number of observations in each level
filter(luc, !is.na(genotype)) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>% # add the object luc_stats (with n and CV)
ggplot( aes(x=KNO3.x , y=RawIntDen_norm_bckg, col=genotype.x))+ # creates the plot with x and y axis
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(1.3),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 8000, position = position_dodge(1.3)) +
#   scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
#                 labels=c(expression(italic("pNRT2.1:LUC")),
#                          expression(italic("Arp6-1/pNRT2.1:LUC"))))+
#scale_color_manual(values = c("#00AFBB", "#CB2027"))+    -> find an other way to do that
geom_text(aes(label=n , x=KNO3.x, y=-10000 ),position=position_dodge(0.8)) + # shows the number of observation
geom_text(aes(label=CV , x=KNO3.x, y=600000 ),position=position_dodge(0.8)) + # shows the CV
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+ # allows you to modify the font size of each element and others elements of layout
xlab(expression(KNO[3]~concentration)) + # allows you to put numbers or others in subscript
ylab("Luciferase signal (Raw integrated density)") +
guides(col="none")
ggsave("RawIntDen_norm_back_20220324_SC_13_9D.jpg", width=10, height = 10)
All_meanForNorm <- filter(luc,!is.na(genotype)) %>%
group_by(genotype, KNO3)%>%
summarise(average.NormRawIntDen = mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE)
All_MeanNormalised <- filter(luc,!is.na(genotype)) %>%
unite(Sample, genotype, KNO3) %>%
full_join(., All_meanForNorm, by="Sample") %>%
mutate(MeanNormalised_RawIntDenSignal=log2(RawIntDen_norm_bckg/average.NormRawIntDen))
Stats_MeanNormalised <- group_by(All_MeanNormalised, genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_norm_bckg,
na.rm = TRUE)/ mean(RawIntDen_norm_bckg, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
All_MeanNormalised <-mutate(All_MeanNormalised, genotype=factor(genotype, levels=c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))) # transform the genotype variable into a factor with different levels
summary(luc$genotype) # shows the number of observations in each level
full_join(All_MeanNormalised,Stats_MeanNormalised, by="Sample") %>%
ggplot( aes(x=KNO3 , y=MeanNormalised_RawIntDenSignal, col=genotype))+
geom_boxplot(aes(color = genotype), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype, color = genotype), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.07, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("Arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=KNO3, y=-3 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3, y=3 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Mean normalised raw integrated density") +
guides(col="none")
ggsave("Mean_norm_data_20220324_SC_13_9D.jpg")
All_meanForNorm <- filter(luc,!is.na(genotype)) %>%
group_by(genotype, KNO3)%>%
summarise(average.NormRawIntDen_normLen = mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE)
All_MeanNormalised <- filter(luc,!is.na(genotype)) %>%
unite(Sample, genotype, KNO3) %>%
full_join(., All_meanForNorm, by="Sample") %>%
mutate(MeanNormalised_RawIntDenSignal=log2(RawIntDen_normBackg_normLen/average.NormRawIntDen_normLen))
Stats_MeanNormalised <- group_by(All_MeanNormalised, genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
All_MeanNormalised <-mutate(All_MeanNormalised, genotype=factor(genotype, levels=c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))) # transform the genotype variable into a factor with different levels
summary(luc$genotype) # shows the number of observations in each level
full_join(All_MeanNormalised,Stats_MeanNormalised, by="Sample") %>%
ggplot( aes(x=KNO3 , y=MeanNormalised_RawIntDenSignal, col=genotype))+
geom_boxplot(aes(color = genotype), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype, color = genotype), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.07, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("Arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=KNO3, y=-3 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3, y=3 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=12),
legend.title = element_text(size=14, face="bold"),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
plot.title = element_text(size=16,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
ggtitle("Coefficients of variation of NRT2.1 expression \n      between the wild type (pNRT2.1) and the \n arp6-1 mutant (arp6-1/pNRT2.1:LUC) at 8 days")+
xlab(expression(KNO[3]~concentration)) +
ylab("Mean normalised raw integrated density \n by background and length (9D)") +
guides(col="none")
ggsave("RawIntDen_normBackg_normLen_20220324_SC_13_9D.jpg")
All_meanForNorm <- filter(luc,!is.na(genotype)) %>%
group_by(genotype, KNO3)%>%
summarise(average.NormRawIntDen_normLen = mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE)
All_MeanNormalised <- filter(luc,!is.na(genotype)) %>%
unite(Sample, genotype, KNO3) %>%
full_join(., All_meanForNorm, by="Sample") %>%
mutate(MeanNormalised_RawIntDenSignal=log2(RawIntDen_normBackg_normLen/average.NormRawIntDen_normLen))
Stats_MeanNormalised <- group_by(All_MeanNormalised, genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
All_MeanNormalised <-mutate(All_MeanNormalised, genotype=factor(genotype, levels=c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))) # transform the genotype variable into a factor with different levels
summary(luc$genotype) # shows the number of observations in each level
full_join(All_MeanNormalised,Stats_MeanNormalised, by="Sample") %>%
ggplot( aes(x=KNO3 , y=MeanNormalised_RawIntDenSignal, col=genotype))+
geom_boxplot(aes(color = genotype), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype, color = genotype), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.07, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("Arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=KNO3, y=-3 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3, y=3 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=12),
legend.title = element_text(size=14, face="bold"),
axis.text=element_text(size=14),
axis.title=element_text(size=14),
plot.title = element_text(size=16,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
ggtitle("Coefficients of variation of NRT2.1 expression \n      between the wild type (pNRT2.1) and the \n arp6-1 mutant (arp6-1/pNRT2.1:LUC) at 9 days \n")+
xlab(expression(KNO[3]~concentration)) +
ylab("Mean normalised raw integrated density \n by background and length (9D) \n") +
guides(col="none")
ggsave("RawIntDen_normBackg_normLen_20220324_SC_13_9D.jpg")
