luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "clf29/pNRT2.1:LUC" ))
filter(Allc, KNO3=="1mM") %>%
ggplot(aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, colour = genotype)) +
scale_color_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("clf29/pNRT2.1:LUC"))))+
geom_point(size=5) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50")) +
ggtitle(expression("plants grown on 1mM"~KNO[3])) +
xlab("N influx HATS (Âµmole N/Gdm/hour)") +
ylab("Luciferase signal (Raw integrated density) \n length normalised ") +
stat_cor(method="spearman", size=5)
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/2022/2022_clf29_pNRT21_LUC_compilation_rep/clf29_replicate_Influx/AV_14_20220523_clf/")
library("tidyverse")
library("ggpubr")
influx_comparison_CV <- read_tsv("20220523_clfpNRT2.1LUC_complet.txt")
influx_comparison_CV$genotype <- fct_relevel(influx_comparison_CV$genotype, c("pNRT2.1:LUC", "clf-29/pNRT2.1:LUC" ))
stat_CV <- group_by(influx_comparison_CV, genotype)%>%
summarise(n=n(),
CV=sd(Ninflux_umoleN_Gms_heure,
na.rm = TRUE)/ mean(Ninflux_umoleN_Gms_heure, na.rm = TRUE)) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
full_join(influx_comparison_CV, stat_CV) %>%
ggplot( aes(x=genotype, y=Ninflux_umoleN_Gms_heure, col=genotype))+
geom_boxplot(aes(color = genotype), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype, color = genotype), binaxis='y', stackdir='center',
dotsize = 3, binwidth = 0.3, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression("pNRT2.1:LUC"),
expression(italic("clf-29/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n, y=9 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV, y=50 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=18),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold", hjust=0.5),
plot.subtitle = element_text(size=18, hjust=0.5),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(method="wilcox.test",
label.x = 1.3,
label.y = 45)+
ggtitle("NRT2.1 activity and coefficients of variation", subtitle=(expression(paste("12-d-old seedling "))))+
xlab(" \n genotype")+
ylab("NRT2.1 activity \n (N Influx) \n ") +
guides(col="none")
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/2022/2022_clf29_pNRT21_LUC_compilation_rep/clf29_replicate_LUC/AV_14_20220509_clf29pNRT21.LUC_rep7/")
library(tidyverse)
library(scales)
luc <- read.table("20220511_Clf29_pNRT2.1_luc_replicate.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV:", round(CV,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "Clf29/pNRT2.1:LUC" ))
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 300, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("clf29/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=KNO3.x, y=0 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3.x, y=12000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal norm lengt") +
guides(col="none")
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/2022/2022_clf29_pNRT21_LUC_compilation_rep/clf29_replicate_Influx/AV_14_20220523_clf/")
library("tidyverse")
library("ggpubr")
influx_comparison_CV <- read_tsv("20220523_clfpNRT2.1LUC_complet.txt")
influx_comparison_CV$genotype <- fct_relevel(influx_comparison_CV$genotype, c("pNRT2.1:LUC", "clf-29/pNRT2.1:LUC" ))
stat_CV <- group_by(influx_comparison_CV, genotype)%>%
summarise(n=n(),
CV=sd(Ninflux_umoleN_Gms_heure,
na.rm = TRUE)/ mean(Ninflux_umoleN_Gms_heure, na.rm = TRUE)) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
full_join(influx_comparison_CV, stat_CV) %>%
ggplot( aes(x=genotype, y=Ninflux_umoleN_Gms_heure, col=genotype))+
geom_boxplot(aes(color = genotype), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype, color = genotype), binaxis='y', stackdir='center',
dotsize = 3, binwidth = 0.3, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression("pNRT2.1:LUC"),
expression(italic("clf-29/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n, y=9 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV, y=50 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=18),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold", hjust=0.5),
plot.subtitle = element_text(size=18, hjust=0.5),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(method="wilcox.test",
label.x = 1.3,
label.y = 45)+
ggtitle("NRT2.1 activity and coefficients of variation", subtitle=(expression(paste("12-d-old seedling "))))+
xlab(" \n genotype")+
ylab("NRT2.1 activity \n (N Influx) \n ") +
guides(col="none")
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/2022/2022_clf29_pNRT21_LUC_compilation_rep/clf29_replicate_Influx/AV_14_20220523_clf/")
library("tidyverse")
library("ggpubr")
influx_comparison_CV <- read_tsv("20220523_clfpNRT2.1LUC_complet.txt")
influx_comparison_CV$genotype <- fct_relevel(influx_comparison_CV$genotype, c("pNRT2.1:LUC", "clf-29/pNRT2.1:LUC" ))
stat_CV <- group_by(influx_comparison_CV, genotype)%>%
summarise(n=n(),
CV=sd(Ninflux_umoleN_Gms_heure,
na.rm = TRUE)/ mean(Ninflux_umoleN_Gms_heure, na.rm = TRUE)) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
full_join(influx_comparison_CV, stat_CV) %>%
ggplot( aes(x=genotype, y=Ninflux_umoleN_Gms_heure, col=genotype))+
geom_boxplot(aes(color = genotype), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype, color = genotype), binaxis='y', stackdir='center',
dotsize = 3, binwidth = 0.3, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression("pNRT2.1:LUC"),
expression(italic("clf-29/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n, y=9 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV, y=50 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=18),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold", hjust=0.5),
plot.subtitle = element_text(size=18, hjust=0.5),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(method="wilcox.test",
label.x = 1.3,
label.y = 45)+
ggtitle("NRT2.1 activity and coefficients of variation", subtitle=(expression(paste("12-d-old seedling "))))+
xlab(" \n genotype")+
ylab("NRT2.1 activity \n (N Influx) \n ") +
guides(col="none")
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/2022/2022_clf29_pNRT21_LUC_compilation_rep/clf29_replicate_LUC/AV_14_20220509_clf29pNRT21.LUC_rep7/")
library(tidyverse)
library(scales)
library(ggpubr)
luc <- read.table("20220511_Clf29_pNRT2.1_luc_replicate.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(n=n()) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "clf29/pNRT2.1:LUC" ))
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.5, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("clf29/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=KNO3.x, y=33 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 35,
label.y = 57) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/AV_26_LBD_pNRT21_luc/20230302_LBD_rep2/")
getwd()
library(tidyverse)
library(scales)
clf29_replicate8 <- read.table("AV_26_20230302_test_carence_9J.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
bind_rows(clf29_replicate8) %>% filter(seedling!="background") %>%
ggplot( aes(x=genotype, y=RawIntDen_normBackg_normLen, col=PLATE))+
geom_boxplot( width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = PLATE), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 200, position = position_dodge(0.8))+
facet_grid(~KNO3, scales= "free")+
theme_bw()+
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"))+
xlab("genotype") +
ylab("RawIntDen_normBackg_normLen")
clf29_replicate8 <- read.table("AV_26_20230302_test_carence_9J.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
bind_rows(clf29_replicate8) %>% filter(seedling!="background") %>%
ggplot( aes(x=genotype, y=RawIntDen_normBackg_normLen, col=PLATE))+
geom_boxplot( width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = PLATE), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 200, position = position_dodge(0.8))+
facet_grid(~KNO3, scales= "free")+
theme_bw()+
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"))+
xlab("genotype") +
ylab("RawIntDen_normBackg_normLen")
luc <- read.table("AV_26_20230302_test_carence_9J.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "LBD/pNRT2.1:LUC" ))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=RawIntDen.norm_bckg, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 5000, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=-10000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3.x, y=300000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal \n (Raw integrated density)") +
guides(col="none")
ggsave("Luciferase_signal_AV_26_9J_rep2.jpg")
All_meanForNorm <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(average.NormRawIntDen = mean(RawIntDen.norm_bckg, na.rm = TRUE),
n=n(),
CV=sd(RawIntDen.norm_bckg,
na.rm = TRUE)/average.NormRawIntDen) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
All_MeanNormalised <- filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(., All_meanForNorm, by="Sample") %>%
mutate(MeanNormalised_RawIntDenSignal=log2(RawIntDen.norm_bckg/average.NormRawIntDen))
ggplot(All_MeanNormalised, aes(x=KNO3.x , y=MeanNormalised_RawIntDenSignal, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.1, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=-3 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3.x, y=1.5 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Mean normalised raw integrated density") +
guides(col="none")
All_meanForNorm <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(average.NormRawIntDen_normLen = mean(RawIntDen_normBackg_normLen,
na.rm = TRUE),
n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/average.NormRawIntDen_normLen) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
All_MeanNormalised <- filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(., All_meanForNorm, by="Sample") %>%
mutate(MeanNormalised_RawIntDenSignal_normLen=
log2(RawIntDen_normBackg_normLen/average.NormRawIntDen_normLen))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "LBD/pNRT2.1:LUC" ))
levels(luc$genotype)
ggplot(All_MeanNormalised, aes(x=KNO3.x , y=MeanNormalised_RawIntDenSignal_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.15, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=-4 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3.x, y=2 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Mean normalised raw integrated density \n (length normalised)") +
guides(col="none")
ggsave("Meannorm_data_length_norm_AV_26_9j_rep2.jpg")
luc <- read.table("AV_26_20230302_test_carence_9J.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
QCD=(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))-
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))/
(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))+
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)),
QCD=paste("QCD =", round(QCD,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "LBD/pNRT2.1:LUC" ))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 250, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3.x, y=8000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=KNO3.x, y=9000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal (Raw integrated density)") +
guides(col="none")
ggsave("RawIntDen_normBackg_normLen_AV_26_9J_rep2.jpg")
library(ggpubr)
luc <- read.table("AV_26_20230302_test_carence_9J.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "LBD/pNRT2.1:LUC" ))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 40) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=10 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 60) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=10 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 50) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
ggsave("length_AV_26_9J_rep2.jpg")
