stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 40) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=KNO3.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 40) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 40) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 70) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
library(ggpubr)
luc <- read.table("AV_25_test_carence_0mM_arp6_pNRT21.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("0mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, DAY, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
mean=mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
mutate(n=paste("n:",n),
CV=paste("CV:", round(CV,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 70) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
ggsave("lenght_root_starvation_OmM_arp6pNRT21.jpg")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
ggtitle("lenght roots for 0mM KNO[3] starvation")+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 70) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
ggtitle("lenght roots for 0mM KNO3 starvation")+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 70) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 70) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
luc <- read.table("AV_25_test_carence_1mM_arp6_pNRT21.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, DAY, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
mean=mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
mutate(n=paste("n:",n),
CV=paste("CV:", round(CV,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 70) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 75) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
ggsave("lenght_roots_starvation_1mM_arp6pNRT21.jpg")
luc <- read.table("AV_25_test_carence_0mM_arp6_pNRT21.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("0mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, DAY, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
mean=mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
mutate(n=paste("n:",n),
CV=paste("CV:", round(CV,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
facet_grid(~KNO3.x, scales= "free")+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 70) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
ggsave("lenght_root_starvation_OmM_arp6pNRT21.jpg")
luc <- read.table("AV_25_test_carence_1mM_arp6_pNRT21.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, DAY, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
mean=mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
mutate(n=paste("n:",n),
CV=paste("CV:", round(CV,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
facet_grid(~KNO3.x, scales= "free")+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 75) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
ggsave("lenght_roots_starvation_1mM_arp6pNRT21.jpg")
luc <- read.table("AV_25_test_carence_0mM_arp6_pNRT21.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("0mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, DAY, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
mean=mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
mutate(n=paste("n:",n),
CV=paste("CV:", round(CV,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "arp6-1/pNRT2.1:LUC"))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, DAY, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=DAY.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
facet_grid(~KNO3.x, scales= "free")+
scale_fill_manual(values = c("#00AFBB", "#CB2027"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("arp6-1/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=DAY.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 70) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
ggsave("lenght_root_starvation_OmM_arp6pNRT21.jpg")
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/AV_26_20230127_LBD_rep1/")
getwd()
library(tidyverse)
library(scales)
luc <- read.table("AV_26_20230127_test_carence_8J.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
QCD=(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))-
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))/
(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))+
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)),
QCD=paste("QCD =", round(QCD,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "LBD/pNRT2.1:LUC" ))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 250, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3.x, y=8000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=KNO3.x, y=9000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal (Raw integrated density)") +
guides(col="none")
library(ggpubr)
luc <- read.table("AV_23_20221019_arp6_pNRT21_MS2_1_10mM_7j.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM", "MS/2")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
luc <- read.table("AV_26_20230127_test_carence_8J.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE)) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "LBD/pNRT2.1:LUC" ))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=length_mm, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 0.6, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=18 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 40) +
xlab(expression(KNO[3]~concentration)) +
ylab("length roots") +
guides(col="none")
ggsave("length_AV_26_8J.jpg")
