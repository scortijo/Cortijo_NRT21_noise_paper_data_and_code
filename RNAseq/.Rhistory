dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_ATP_biosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_ATP_biosynthesis <- inner_join(Rcor_NRT2.1_genes_ATP_biosynthesis, Pcor_NRT2.1_genes_ATP_biosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Photosynthesis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Photosynthesis <- inner_join(Rcor_NRT2.1_genes_Photosynthesis, Pcor_NRT2.1_genes_Photosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("TCAcycle_mitocondrialET","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_TCAcycle_mitocondrialET <- inner_join(Rcor_NRT2.1_genes_TCAcycle_mitocondrialET, Pcor_NRT2.1_genes_TCAcycle_mitocondrialET, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Tetrapyrrole","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Tetrapyrrole <- inner_join(Rcor_NRT2.1_genes_Tetrapyrrole, Pcor_NRT2.1_genes_Tetrapyrrole, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
genes_Nnutrition <- read_tsv("SC18_data/Genes_interest.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition <- inner_join(CPM_SC18_all_WT_Zscore, genes_Nnutrition, by="gene") %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
mutate(type="Nnutrition")
Pcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Nnutrition <- inner_join(Rcor_NRT2.1_genes_Nnutrition, Pcor_NRT2.1_genes_Nnutrition, by="gene") %>%
filter(gene!="AT1G08090")
Corr_NRT2.1_genes_all_groups <- bind_rows(Corr_NRT2.1_genes_Glycolysis, Corr_NRT2.1_genes_Asp_family_pathway, Corr_NRT2.1_genes_ATP_biosynthesis, Corr_NRT2.1_genes_Photosynthesis,Corr_NRT2.1_genes_TCAcycle_mitocondrialET, Corr_NRT2.1_genes_Tetrapyrrole, Corr_NRT2.1_genes_Nnutrition) %>%
mutate(Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05"))
write_tsv(Corr_NRT2.1_genes_all_groups, file="Corr_NRT2.1_genes_all_groups.txt")
Perc_signif <- group_by(Corr_NRT2.1_genes_all_groups, type, Pthreshold) %>%
summarise(nobs=n()) %>%
pivot_wider(names_from = Pthreshold, values_from = nobs) %>%
mutate(perc_signif=(less0.05/(less0.05+more0.05))*100,
perc_signif=paste(round(perc_signif), "%", sep="")) %>%
arrange(desc(perc_signif)) %>%
mutate(type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")))
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
full_join(Perc_signif, by="type") %>%
ggplot(aes(x=type, y=Rcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.05) +
geom_text(data=Perc_signif, aes(y=-0.8,x=type, label=perc_signif)) +
xlab("") +
ylab(expression(paste("R score of correlation test with ", italic("NRT2.1")))) +
scale_x_discrete(labels = c("Photosynthesis" = "Photosynthesis","Tetrapyrrole" = "Tetrapyrrole",
"Glycolysis" = "Glycolysis","Nnutrition"="Nitrogen nutrition",
"Asp_family_pathway" = "Asp pathway","TCAcycle_mitocondrialET"= "TCA cycle",
"ATP_biosynthesis"= "ATP biosynthesis")) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1, colour = c("orange","orange","darkblue", "orange","orange","orange","orange")))
ggsave("Rcor_NRT2.1_genes_energie.jpg", width = 8, height = 5.5)
group_by(Corr_NRT2.1_genes_all_groups, type) %>%
summarise(medPcor=median(Pcor)) %>%
arrange(medPcor)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Tetrapyrrole", "Glycolysis", "Nnutrition",
"Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=type, y=Pcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.1) +
scale_y_log10()+
xlab("") +
ylab(expression(paste("p-value of correlation test with ", italic("NRT2.1")))) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
scale_x_discrete(labels = c("Photosynthesis" = "Photosynthesis","Tetrapyrrole" = "Tetrapyrrole",
"Glycolysis" = "Glycolysis","Nnutrition"="Nitrogen nutrition",
"Asp_family_pathway" = "Asp pathway","TCAcycle_mitocondrialET"= "TCA cycle",
"ATP_biosynthesis"= "ATP biosynthesis")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1, colour = c("orange","orange", "orange","darkblue","orange","orange","orange")))
ggsave("Pcor_NRT2.1_genes_energie.jpg", width = 8, height = 5.5)
group_by(Corr_NRT2.1_genes_all_groups, type) %>%
summarize(nobs = n(),
n_less0.5 = sum(Pcor < 0.05),
prop_less0.5 = n_less0.5 / nobs) %>%
arrange(desc(prop_less0.5))
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point(size=2, alpha=0.8) +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point(size=3, alpha=0.6) +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point(size=3, alpha=0.6) +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
cluster_info <- dplyr::select(AllClusters, gene, cluster_6_pearson)
CPM_SC18_all_WT_Zscore_1ColperGene <- pivot_longer(AllClusters, cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(gene, seedling, Zscore_normalised_expression) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_clusters <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(cluster_info, by="gene")
Pcor_NRT2.1_genes_clusters <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_clusters <- inner_join(Rcor_NRT2.1_genes_clusters, Pcor_NRT2.1_genes_clusters, by="gene") %>%
filter(gene!="AT1G08090")
mutate(Corr_NRT2.1_genes_clusters, cluster_6_pearson=paste("cluster", cluster_6_pearson)) %>%
mutate(cluster_6_pearson=factor(cluster_6_pearson, levels=c("cluster 1", "cluster 2", "cluster 3",
"cluster 4", "cluster 5", "cluster 6")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr)) +
geom_point() +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~cluster_6_pearson, ncol = 3) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_NRT2.1_clusters.jpg", width=12, height=7)
cluster_info <- dplyr::select(AllClusters, gene, cluster_6_pearson)
CPM_SC18_all_WT_Zscore_1ColperGene <- pivot_longer(AllClusters, cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(gene, seedling, Zscore_normalised_expression) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_clusters <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(cluster_info, by="gene")
Pcor_NRT2.1_genes_clusters <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_clusters <- inner_join(Rcor_NRT2.1_genes_clusters, Pcor_NRT2.1_genes_clusters, by="gene") %>%
filter(gene!="AT1G08090")
mutate(Corr_NRT2.1_genes_clusters, cluster_6_pearson=paste("cluster", cluster_6_pearson)) %>%
mutate(cluster_6_pearson=factor(cluster_6_pearson, levels=c("cluster 1", "cluster 2", "cluster 3",
"cluster 4", "cluster 5", "cluster 6")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr)) +
geom_point() +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~cluster_6_pearson, ncol = 3) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_NRT2.1_clusters.jpg", width=10, height=4)
cluster_info <- dplyr::select(AllClusters, gene, cluster_6_pearson)
CPM_SC18_all_WT_Zscore_1ColperGene <- pivot_longer(AllClusters, cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(gene, seedling, Zscore_normalised_expression) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_clusters <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(cluster_info, by="gene")
Pcor_NRT2.1_genes_clusters <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_clusters <- inner_join(Rcor_NRT2.1_genes_clusters, Pcor_NRT2.1_genes_clusters, by="gene") %>%
filter(gene!="AT1G08090")
mutate(Corr_NRT2.1_genes_clusters, cluster_6_pearson=paste("cluster", cluster_6_pearson)) %>%
mutate(cluster_6_pearson=factor(cluster_6_pearson, levels=c("cluster 1", "cluster 2", "cluster 3",
"cluster 4", "cluster 5", "cluster 6")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr)) +
geom_point() +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~cluster_6_pearson, ncol = 3) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_NRT2.1_clusters.jpg", width=10, height=5)
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
genes_energy <- read_tsv("SC18_data/genes_energy.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Glycolysis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Glycolysis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Glycolysis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Glycolysis <- inner_join(Rcor_NRT2.1_genes_Glycolysis, Pcor_NRT2.1_genes_Glycolysis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Asp_family_pathway","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Asp_family_pathway <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Asp_family_pathway <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Asp_family_pathway <- inner_join(Rcor_NRT2.1_genes_Asp_family_pathway, Pcor_NRT2.1_genes_Asp_family_pathway, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("ATP_biosynthesis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_ATP_biosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_ATP_biosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_ATP_biosynthesis <- inner_join(Rcor_NRT2.1_genes_ATP_biosynthesis, Pcor_NRT2.1_genes_ATP_biosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Photosynthesis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Photosynthesis <- inner_join(Rcor_NRT2.1_genes_Photosynthesis, Pcor_NRT2.1_genes_Photosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("TCAcycle_mitocondrialET","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_TCAcycle_mitocondrialET <- inner_join(Rcor_NRT2.1_genes_TCAcycle_mitocondrialET, Pcor_NRT2.1_genes_TCAcycle_mitocondrialET, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Tetrapyrrole","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Tetrapyrrole <- inner_join(Rcor_NRT2.1_genes_Tetrapyrrole, Pcor_NRT2.1_genes_Tetrapyrrole, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
genes_Nnutrition <- read_tsv("SC18_data/Genes_interest.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition <- inner_join(CPM_SC18_all_WT_Zscore, genes_Nnutrition, by="gene") %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
mutate(type="Nnutrition")
Pcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Nnutrition <- inner_join(Rcor_NRT2.1_genes_Nnutrition, Pcor_NRT2.1_genes_Nnutrition, by="gene") %>%
filter(gene!="AT1G08090")
cell_wall <- read_tsv("SC18_data/genes_cell_wall_Hartasanchez.txt")
View(cell_wall)
cell_wall
cell_wall <- read_tsv("SC18_data/genes_cell_wall_Hartasanchez.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_cellWall <- inner_join(CPM_SC18_all_WT_Zscore, cell_wall, by="gene") %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
CPM_SC18_all_WT_Zscore_1ColperGene_cellWall
Rcor_NRT2.1_genes_cellWall <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_cellWall, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_cellWall$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(cell_wall, by="gene")
Pcor_NRT2.1_genes_cellWall
Rcor_NRT2.1_genes_cellWall
View(CPM_SC18_all_WT_Zscore)
View(CPM_SC18_all_WT)
Pcor_NRT2.1_genes_cellWall <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_cellWall, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_cellWall$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_cellWall <- inner_join(Rcor_NRT2.1_genes_cellWall, Pcor_NRT2.1_genes_cellWall, by="gene") %>%
filter(gene!="AT1G08090")
Corr_NRT2.1_genes_cellWall
Corr_NRT2.1_genes_all_groups <- bind_rows(Corr_NRT2.1_genes_Glycolysis, Corr_NRT2.1_genes_Asp_family_pathway, Corr_NRT2.1_genes_ATP_biosynthesis, Corr_NRT2.1_genes_Photosynthesis,Corr_NRT2.1_genes_TCAcycle_mitocondrialET, Corr_NRT2.1_genes_Tetrapyrrole, Corr_NRT2.1_genes_Nnutrition, Corr_NRT2.1_genes_cellWall) %>%
mutate(Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05"))
Corr_NRT2.1_genes_all_groups
group_by(Corr_NRT2.1_genes_all_groups,type, Pthreshold) %>%  summarise(nb=n())
group_by(Corr_NRT2.1_genes_all_groups,type, Pthreshold) %>%  summarise(nb=n()) %>%  pivot_wider(names_from = Pthreshold, values_from = nb)
group_by(Corr_NRT2.1_genes_all_groups,type, Pthreshold) %>%  summarise(nb=n()) %>%  pivot_wider(names_from = Pthreshold, values_from = nb) %>%  mutate(PercSignif=less0.05/(less0.05+more0.05))
group_by(Corr_NRT2.1_genes_all_groups,type, Pthreshold) %>%  summarise(nb=n()) %>%  pivot_wider(names_from = Pthreshold, values_from = nb) %>%  mutate(PercSignif=(less0.05/(less0.05+more0.05))*100)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "cell_wall", "Asp_family_pathway", "TCAcycle_mitocondrialET",
"ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point(size=3, alpha=0.6) +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
Corr_NRT2.1_genes_cellWall <- inner_join(Rcor_NRT2.1_genes_cellWall, Pcor_NRT2.1_genes_cellWall, by="gene") %>%
filter(gene!="AT1G08090") %>%
drop_na()
Corr_NRT2.1_genes_cellWall
Corr_NRT2.1_genes_all_groups <- bind_rows(Corr_NRT2.1_genes_Glycolysis, Corr_NRT2.1_genes_Asp_family_pathway, Corr_NRT2.1_genes_ATP_biosynthesis, Corr_NRT2.1_genes_Photosynthesis,Corr_NRT2.1_genes_TCAcycle_mitocondrialET, Corr_NRT2.1_genes_Tetrapyrrole, Corr_NRT2.1_genes_Nnutrition, Corr_NRT2.1_genes_cellWall) %>%
mutate(Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05"))
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "cell_wall", "Asp_family_pathway", "TCAcycle_mitocondrialET",
"ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point(size=3, alpha=0.6) +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
group_by(Corr_NRT2.1_genes_all_groups,type, Pthreshold) %>%  summarise(nb=n()) %>%  pivot_wider(names_from = Pthreshold, values_from = nb) %>%  mutate(PercSignif=(less0.05/(less0.05+more0.05))*100, tot=less0.05+more0.05)
