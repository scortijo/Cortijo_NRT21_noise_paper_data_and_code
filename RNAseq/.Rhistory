ggsave("Pcor_NRT2.1_genes_activated_metabolites_sugars.jpg", width = 7, height = 5.5)
group_by(Corr_NRT2.1_genes, type) %>%
summarize(nobs = n(),
n_less0.5 = sum(Pcor < 0.05),
prop_less0.5 = n_less0.5 / nobs) %>%
arrange(desc(prop_less0.5))
group_by(Corr_NRT2.1_genes, metabolite) %>%
summarize(nobs = n(),
n_less0.5 = sum(Pcor < 0.05),
prop_less0.5 = n_less0.5 / nobs) %>%
arrange(desc(prop_less0.5))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
gene_types <- read_tsv("SC18_data/Genes_interest.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.xls")
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
View(targets_NLP7)
CPM_SC18_all_WT_Zscore
targets_NLP7
inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI"))
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
targets_NLP7
inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI"))
inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name, -nitrate_response_nlp7_compared_wt)
inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, -nitrate_response_nlp7_compared_wt)
inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, -nitrate_response_nlp7_compared_wt) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression)
CPM_SC18_all_WT_Zscore_1ColperGene_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, -nitrate_response_nlp7_compared_wt) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Rcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(targets_NLP7, by=c("gene"="AGI"))
Rcor_NRT2.1_genes_nlp7
Pcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Pcor_NRT2.1_genes_nlp7
Corr_NRT2.1_genes_Glycolysis <- inner_join(Rcor_NRT2.1_genes_nlp7, Pcor_NRT2.1_genes_nlp7, by="gene") %>%
filter(gene!="AT1G08090")
Corr_NRT2.1_genes_Glycolysis
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
gene_types <- read_tsv("SC18_data/Genes_interest.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
gene_types <- read_tsv("SC18_data/Genes_interest.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
options(scipen=999)
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, -nitrate_response_nlp7_compared_wt) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(targets_NLP7, by=c("gene"="AGI"))
Pcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Glycolysis <- inner_join(Rcor_NRT2.1_genes_nlp7, Pcor_NRT2.1_genes_nlp7, by="gene") %>%
filter(gene!="AT1G08090")
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, -nitrate_response_nlp7_compared_wt) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(targets_NLP7, by=c("gene"="AGI"))
Pcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_nlp7 <- inner_join(Rcor_NRT2.1_genes_nlp7, Pcor_NRT2.1_genes_nlp7, by="gene") %>%
filter(gene!="AT1G08090")
Corr_NRT2.1_genes_nlp7
ggplot(Corr_NRT2.1_genes_nlp7,aes(x=type, y=Rcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.05) +
xlab("") +
ylab(expression(paste("R score of correlation test with ", italic("NRT2.1")))) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(aes(x=type, y=Rcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.05) +
xlab("") +
ylab(expression(paste("R score of correlation test with ", italic("NRT2.1")))) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1))
mutate(Corr_NRT2.1_genes_nlp7, Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05")) %>%
ggplot(aes(x=type, y=Rcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.05) +
xlab("") +
ylab(expression(paste("R score of correlation test with ", italic("NRT2.1")))) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1))
Corr_NRT2.1_genes_nlp7
mutate(Corr_NRT2.1_genes_nlp7, Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05")) %>%
ggplot(aes(x=nitrate_response_nlp7_compared_wt, y=Rcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.05) +
xlab("") +
ylab(expression(paste("R score of correlation test with ", italic("NRT2.1")))) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1))
mutate(Corr_NRT2.1_genes_nlp7, Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05")) %>%
group_by( nitrate_response_nlp7_compared_wt) %>%
summarize(nobs = n(),
n_less0.5 = sum(Pcor < 0.05),
prop_less0.5 = n_less0.5 / nobs) %>%
arrange(desc(prop_less0.5))
mutate(Corr_NRT2.1_genes_nlp7, Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05")) %>%
group_by( type) %>%
summarize(nobs = n(),
n_less0.5 = sum(Pcor < 0.05),
prop_less0.5 = n_less0.5 / nobs) %>%
arrange(desc(prop_less0.5))
knitr::opts_chunk$set(echo = TRUE)
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
gene_types <- read_tsv("SC18_data/Genes_interest.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
options(scipen=999)
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, -nitrate_response_nlp7_compared_wt) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(targets_NLP7, by=c("gene"="AGI"))
Pcor_NRT2.1_genes_nlp7 <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_nlp7, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_nlp7$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_nlp7 <- inner_join(Rcor_NRT2.1_genes_nlp7, Pcor_NRT2.1_genes_nlp7, by="gene") %>%
filter(gene!="AT1G08090")
mutate(Corr_NRT2.1_genes_nlp7, Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05")) %>%
ggplot(aes(x=type, y=Rcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.05) +
xlab("") +
ylab(expression(paste("R score of correlation test with ", italic("NRT2.1")))) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1))
mutate(Corr_NRT2.1_genes_nlp7, Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05")) %>%
ggplot(aes(x=nitrate_response_nlp7_compared_wt, y=Rcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.05) +
xlab("") +
ylab(expression(paste("R score of correlation test with ", italic("NRT2.1")))) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1))
mutate(Corr_NRT2.1_genes_nlp7, Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05")) %>%
group_by( nitrate_response_nlp7_compared_wt) %>%
summarize(nobs = n(),
n_less0.5 = sum(Pcor < 0.05),
prop_less0.5 = n_less0.5 / nobs) %>%
arrange(desc(prop_less0.5))
mutate(Corr_NRT2.1_genes_nlp7, Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05")) %>%
group_by( type) %>%
summarize(nobs = n(),
n_less0.5 = sum(Pcor < 0.05),
prop_less0.5 = n_less0.5 / nobs) %>%
arrange(desc(prop_less0.5))
targets_NLP7 <- read_tsv("NLP7_targets_Marchive_2013.txt")
CPM_SC18_all_WT_Zscore_long_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
CPM_SC18_all_WT_Zscore_long_nlp7 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene=="AT1G08090") %>%
mutate(seedling=fct_reorder(seedling, Zscore_normalised_expression))
CPM_SC18_all_WT_Zscore_long_lessNRT2.1 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene!="AT1G08090")
CPM_SC18_all_WT_Zscore_long_NRT21 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene=="AT1G08090") %>%
mutate(seedling=fct_reorder(seedling, Zscore_normalised_expression))
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene!="AT1G08090")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=name, color=name), size=1.5) +
ylab("Zscore normalised expression") +
ggtitle("Genes regulated by NLP7") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank())
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7
CPM_SC18_all_WT_Zscore_long_nlp7 <- inner_join(CPM_SC18_all_WT_Zscore, targets_NLP7, by=c("gene"="AGI")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression")
CPM_SC18_all_WT_Zscore_long_nlp7
CPM_SC18_all_WT_Zscore_long_NRT21 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene=="AT1G08090") %>%
mutate(seedling=fct_reorder(seedling, Zscore_normalised_expression))
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7 <- filter(CPM_SC18_all_WT_Zscore_long_nlp7, gene!="AT1G08090")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=name, color=name), size=1.5) +
ylab("Zscore normalised expression") +
ggtitle("Genes regulated by NLP7") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank())
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=gene, color=gene), size=1.5) +
ylab("Zscore normalised expression") +
ggtitle("Genes regulated by NLP7") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank())
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=gene, color=gene), size=1.5) +
ylab("Zscore normalised expression") +
ggtitle("Genes regulated by NLP7") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=gene, color=gene), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle("Genes regulated by NLP7") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
targets_NLP7
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=gene, color=gene), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle("Genes regulated by NLP7") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Correlation_NRT2.1_NLP7targets_seedlings.jpg", width=5, height=4)
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7_up, aes(x=seedling, y=Zscore_normalised_expression, group=gene, color=gene), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle("Genes upregulated in nlp7 mutant") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7_up <- filter(CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7,
nitrate_response_nlp7_compared_wt=="up")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7_up, aes(x=seedling, y=Zscore_normalised_expression, group=gene, color=gene), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle("Genes upregulated in nlp7 mutant") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7_up, aes(x=seedling, y=Zscore_normalised_expression, group=gene, color=gene), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle("Genes upregulated in nlp7 mutant") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Correlation_NRT2.1_NLP7targets_upregulated_seedlings.jpg", width=5, height=4)
CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7_down <- filter(CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7,
nitrate_response_nlp7_compared_wt=="down")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_point(size=2) +
geom_line(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7_down, aes(x=seedling, y=Zscore_normalised_expression, group=gene, color=gene), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle("Genes downregulated in nlp7 mutant") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Correlation_NRT2.1_NLP7targets_downregulated_seedlings.jpg", width=5, height=4)
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle("Genes regulated by NLP7") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
?geom_smooth
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=1.5, aes(group=gene)) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression, group=cluster_6_pearson, color=cluster_6_pearson)) +
ylab("Zscore normalised expression") +
ggtitle("Expression in NRT2.1 cluster") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle("Genes regulated by NLP7") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Expression_nlp7Targets_smooth_NRT2.1.jpg", width=5, height = 5)
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle(expression(paste("Genes regulated by ", italic("NLP7"))))
ggplot(CPM_SC18_all_WT_Zscore_long_NRT21, aes(x=seedling, y=Zscore_normalised_expression)) +
geom_line(size=2) +
geom_smooth(data=CPM_SC18_all_WT_Zscore_long_lessNRT2.1_nlp7, aes(x=seedling, y=Zscore_normalised_expression, group=type, color=type), size=1.5) +
geom_point(size=2) +
ylab("Zscore normalised expression") +
ggtitle(expression(paste("Genes regulated by ", italic("NLP7")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=18),
panel.background = element_rect(fill = "white", colour = "grey50"),axis.text.x=element_blank(),
legend.position = "none")
ggsave("Expression_nlp7Targets_smooth_NRT2.1.jpg", width=5, height = 5)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
genes_energy <- read_tsv("SC18_data/genes_energy.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Glycolysis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Glycolysis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Glycolysis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Glycolysis <- inner_join(Rcor_NRT2.1_genes_Glycolysis, Pcor_NRT2.1_genes_Glycolysis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Photosynthesis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Photosynthesis <- inner_join(Rcor_NRT2.1_genes_Photosynthesis, Pcor_NRT2.1_genes_Photosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
Corr_NRT2.1_genes_Photosynthesis
View(Corr_NRT2.1_genes_Photosynthesis)
