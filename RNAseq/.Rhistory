Rcor_NRT2.1_genes_ATP_biosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_ATP_biosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_ATP_biosynthesis <- inner_join(Rcor_NRT2.1_genes_ATP_biosynthesis, Pcor_NRT2.1_genes_ATP_biosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Photosynthesis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Photosynthesis <- inner_join(Rcor_NRT2.1_genes_Photosynthesis, Pcor_NRT2.1_genes_Photosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("TCAcycle_mitocondrialET","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_TCAcycle_mitocondrialET <- inner_join(Rcor_NRT2.1_genes_TCAcycle_mitocondrialET, Pcor_NRT2.1_genes_TCAcycle_mitocondrialET, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Tetrapyrrole","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Tetrapyrrole <- inner_join(Rcor_NRT2.1_genes_Tetrapyrrole, Pcor_NRT2.1_genes_Tetrapyrrole, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
genes_Nnutrition <- read_tsv("SC18_data/Genes_interest.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition <- inner_join(CPM_SC18_all_WT_Zscore, genes_Nnutrition, by="gene") %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
mutate(type="Nnutrition")
Pcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Nnutrition <- inner_join(Rcor_NRT2.1_genes_Nnutrition, Pcor_NRT2.1_genes_Nnutrition, by="gene") %>%
filter(gene!="AT1G08090")
Corr_NRT2.1_genes_all_groups <- bind_rows(Corr_NRT2.1_genes_Glycolysis, Corr_NRT2.1_genes_Asp_family_pathway, Corr_NRT2.1_genes_ATP_biosynthesis, Corr_NRT2.1_genes_Photosynthesis,Corr_NRT2.1_genes_TCAcycle_mitocondrialET, Corr_NRT2.1_genes_Tetrapyrrole, Corr_NRT2.1_genes_Nnutrition) %>%
mutate(Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05"))
write_tsv(Corr_NRT2.1_genes_all_groups, file="Corr_NRT2.1_genes_all_groups.txt")
Perc_signif <- group_by(Corr_NRT2.1_genes_all_groups, type, Pthreshold) %>%
summarise(nobs=n()) %>%
pivot_wider(names_from = Pthreshold, values_from = nobs) %>%
mutate(perc_signif=(less0.05/(less0.05+more0.05))*100,
perc_signif=paste(round(perc_signif), "%", sep="")) %>%
arrange(desc(perc_signif)) %>%
mutate(type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")))
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
full_join(Perc_signif, by="type") %>%
ggplot(aes(x=type, y=Rcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.05) +
geom_text(data=Perc_signif, aes(y=-0.8,x=type, label=perc_signif)) +
xlab("") +
ylab(expression(paste("R score of correlation test with ", italic("NRT2.1")))) +
scale_x_discrete(labels = c("Photosynthesis" = "Photosynthesis","Tetrapyrrole" = "Tetrapyrrole",
"Glycolysis" = "Glycolysis","Nnutrition"="Nitrogen nutrition",
"Asp_family_pathway" = "Asp pathway","TCAcycle_mitocondrialET"= "TCA cycle",
"ATP_biosynthesis"= "ATP biosynthesis")) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1, colour = c("orange","orange","darkblue", "orange","orange","orange","orange")))
ggsave("Rcor_NRT2.1_genes_energie.jpg", width = 8, height = 5.5)
group_by(Corr_NRT2.1_genes_all_groups, type) %>%
summarise(medPcor=median(Pcor)) %>%
arrange(medPcor)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Tetrapyrrole", "Glycolysis", "Nnutrition",
"Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=type, y=Pcor)) +
geom_violin() +
geom_jitter(aes(col=Pthreshold),height = 0, width = 0.1) +
scale_y_log10()+
xlab("") +
ylab(expression(paste("p-value of correlation test with ", italic("NRT2.1")))) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05")) +
scale_x_discrete(labels = c("Photosynthesis" = "Photosynthesis","Tetrapyrrole" = "Tetrapyrrole",
"Glycolysis" = "Glycolysis","Nnutrition"="Nitrogen nutrition",
"Asp_family_pathway" = "Asp pathway","TCAcycle_mitocondrialET"= "TCA cycle",
"ATP_biosynthesis"= "ATP biosynthesis")) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"),
axis.text.x = element_text(angle = 45, hjust = 1, colour = c("orange","orange", "orange","darkblue","orange","orange","orange")))
ggsave("Pcor_NRT2.1_genes_energie.jpg", width = 8, height = 5.5)
group_by(Corr_NRT2.1_genes_all_groups, type) %>%
summarize(nobs = n(),
n_less0.5 = sum(Pcor < 0.05),
prop_less0.5 = n_less0.5 / nobs) %>%
arrange(desc(prop_less0.5))
Corr_NRT2.1_genes_all_groups
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor)) +
geom_point()
Corr_NRT2.1_genes_all_groups
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point() +
facet_wrap(.~type)
Corr_NRT2.1_genes_all_groups
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
facet_wrap(.~type)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
facet_wrap(.~type)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
facet_wrap(.~type) +
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
facet_wrap(.~type) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=8, height=8)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
facet_wrap(.~type) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=8, height=8)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=8, height=8)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=10, height=8)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
scale_x_log10() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=8)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=1&, height=7)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=11, height=7)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=11.5, height=7)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=15),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=14),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=13),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis"))) %>%
ggplot( aes(x=Pcor, y=Rcor, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point() +
xlab("p-value") +
ylab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point() +
ylab("-(log10(p-value)") +
xlab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point() +
ylab("-log10(p-value") +
xlab("correlation R score") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
-log(0.05,10)
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point() +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.7, col="lightgrey") +
geom_vline(xintercept = 0.7, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point() +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggplot(Corr_NRT2.1_genes_all_groups, aes(x=Pcor, y=Rcor, col=type)) +
geom_point()
mutate(Corr_NRT2.1_genes_all_groups, type=factor(type, levels=c("Photosynthesis", "Glycolysis", "Nnutrition",
"Tetrapyrrole", "Asp_family_pathway", "TCAcycle_mitocondrialET", "ATP_biosynthesis")),
logCorr=-log(Pcor, 10)) %>%
ggplot( aes(x=Rcor, y=logCorr, col=Pthreshold)) +
geom_point() +
ylab("correlation significance (-log10(p-value)") +
xlab("Spearman coefficient of correlation (R)") +
geom_vline(xintercept = -0.5, col="lightgrey") +
geom_vline(xintercept = 0.5, col="lightgrey") +
geom_hline(yintercept = 1.30103, col="lightgrey") +
facet_wrap(.~type, ncol = 4) +
scale_color_brewer(palette="Set2", name="P-value",labels=c("less0.05"="Lower than 0.05", "more0.05"="Higher than 0.05"))+
theme(legend.text=element_text(size=15),legend.title = element_text(size=15, face="bold"),
axis.text=element_text(size=14), axis.title=element_text(size=15),
plot.title = element_text(size=16),strip.text = element_text( face="bold", size=12),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave(file="volcano_plot_cor_energy_genes_NRT2.2.jpg", width=12, height=7)
