knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
#rep1
MO1 <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/MO1_transgenerational/Mo_01_20230418.txt")
MO2 <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/MO2_transgenerational/Mo_02_20230424.txt")
MO3 <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/MO3_transgenerational/Mo_03_20230512.txt")
rep1 <- bind_rows(MO1,MO2 ,MO3) %>%
mutate(expt="rep1")
#rep2
SC48 <- read_tsv("rep2_SC48_SC49_transgenerational/SC48_transgenerational/SC48_TransGen_luc_signal.txt")
SC49 <- read_tsv("rep2_SC48_SC49_transgenerational/SC49_transgenerational/SC49_transGenerational_luc_signal.txt")
rep2 <- bind_rows(SC48,SC49 ) %>%
mutate(expt="rep2")
rep1_2 <- rbind(rep1,rep2)
rep1_2_norm <- mutate(rep1_2, RawIntDenDivArea=RawIntDen/area) %>%
filter(seedling=="background") %>%
group_by(genotype, plate, expt) %>%
summarise(MeanBack=mean(RawIntDenDivArea)) %>%
full_join(rep1_2, by=c("genotype"="genotype", "plate"="plate", "expt"="expt")) %>%
mutate(RawIntDen_NormBack= RawIntDen-(MeanBack*area)) %>%
mutate(root_length_mm= length/4,
RawIntDen_NormBack_NormLen=RawIntDen_NormBack/root_length_mm) %>%
filter(seedling!="background")
rep1_parents <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/Rep1_parents_transgenerational_selection/Rep1_parents_transgenerational_selection.txt") %>%
mutate(expt="rep1")
rep2_parents <- read_tsv("rep2_SC48_SC49_transgenerational/Rep2_parents_transgenerational_selection/Rep2_parents_transgenerational_selection.txt") %>%
mutate(expt="rep2")
rep1_2_parents <- rbind(rep1_parents,rep2_parents)
# Normalisation of signal by the background and root length
rep1_2_parents_norm <- mutate(rep1_2_parents, RawIntDenDivArea_Parent=RawIntDen_Parent/area_Parent) %>%
filter(seedling_Parent=="background") %>%
group_by(genotype_Parent, PLATE_Parent, expt) %>%
summarise(MeanBack_Parent=mean(RawIntDenDivArea_Parent)) %>%
full_join(rep1_2_parents, by=c("genotype_Parent"="genotype_Parent", "PLATE_Parent"="PLATE_Parent", "expt"="expt")) %>%
mutate(RawIntDen_NormBack_Parent= RawIntDen_Parent-(MeanBack_Parent*area_Parent)) %>%
mutate(root_length_mm_Parent= length_Parent/4,
RawIntDen_NormBack_NormLen_Parent=RawIntDen_NormBack_Parent/root_length_mm_Parent) %>%
filter(seedling_Parent!="background")
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 6)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 6)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 6)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 6)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 6)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 6)
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 6)
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other",
!Parent_name%in%c("line10", "line19")) %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high")),
Parent_name=factor(Parent_name, levels=c("line2", "line3", "line6", "line9",
"line11", "line12", "line13", "line14", "line17"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, shape=type_Parent, col=Parent_name)) +
geom_jitter(size=3, width = 0.03, height = 0) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_brewer(palette = "Paired", name="Line", labels=c("A", "B", "C", "D", "E",
"F", "G", "H", "I")) +
scale_shape(name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 5, width = 6)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
luc_SC13 <- read_tsv("SC13_1mM_10mM_distribution/20220324_SC_13_9D_analyse.txt")
luc_SC13_norm <- mutate(luc_SC13, RawIntDenDivArea=raw_integrated_density/area) %>%
filter(seedling=="background") %>%
group_by(KNO3, plate) %>%
summarise(MeanBack=mean(RawIntDenDivArea)) %>%
full_join(luc_SC13, by=c(  "KNO3"="KNO3", "plate"="plate")) %>%
mutate(RawIntDen_NormBack= raw_integrated_density-(MeanBack*area)) %>%
mutate(root_length_mm= length/4,
RawIntDen_NormBack_NormLen=RawIntDen_NormBack/root_length_mm) %>%
filter(seedling!="background")
mutate(luc_SC13_norm, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=KNO3, y=RawIntDen_NormBack_NormLen)) +
geom_boxplot()+
geom_jitter(height=0, width=0.15) +
xlab(bquote('Concentration of KNO'[3]*' in growth media')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
mutate(luc_SC13_norm, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=KNO3, y=RawIntDen_NormBack_NormLen)) +
geom_boxplot()+
geom_jitter(height=0, width=0.15) +
xlab(bquote('Concentration of KNO'[3]*' in growth media')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50")) +
stat_compare_means()
?stat_compare_means
mutate(luc_SC13_norm, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=KNO3, y=RawIntDen_NormBack_NormLen)) +
geom_boxplot()+
geom_jitter(height=0, width=0.15) +
xlab(bquote('Concentration of KNO'[3]*' in growth media')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50")) +
stat_compare_means(label.x=1)
mutate(luc_SC13_norm, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=KNO3, y=RawIntDen_NormBack_NormLen)) +
geom_boxplot()+
geom_jitter(height=0, width=0.15) +
xlab(bquote('Concentration of KNO'[3]*' in growth media')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50")) +
stat_compare_means(label.x=1.5)
mutate(luc_SC13_norm, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=KNO3, y=RawIntDen_NormBack_NormLen)) +
geom_boxplot()+
geom_jitter(height=0, width=0.15) +
xlab(bquote('Concentration of KNO'[3]*' in growth media')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50")) +
stat_compare_means(label.x=1.3)
mutate(luc_SC13_norm, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=KNO3, y=RawIntDen_NormBack_NormLen)) +
geom_boxplot()+
geom_jitter(height=0, width=0.15) +
xlab(bquote('Concentration of KNO'[3]*' in growth media')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50")) +
stat_compare_means(label.x=1.3)
ggsave("Distribution_1mM_10mM_SC13.jpg", height = 4.3, width = 4.8)
