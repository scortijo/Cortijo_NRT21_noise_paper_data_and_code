theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3, label.x =20) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=4, label.x =20) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =18) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
gene_types <- read_tsv("SC18_data/Genes_interest.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
BrenneckeGetVariableGenesMod <- function(expr_mat, spikes=NA, suppress.plot=FALSE, fdr=0.1, minBiolDisp=0.5, fitMeanQuantile=0.8) {
#require(statmod)
rowVars <- function(x) { unlist(apply(x,1,var, na.rm=TRUE))}
colGenes <- "black"
colSp <- "blue"
fullCountTable <- expr_mat;
if (is.character(spikes)) {
sp <- rownames(fullCountTable) %in% spikes;
countsSp <- fullCountTable[sp,];
countsGenes <- fullCountTable[!sp,];
} else if (is.numeric(spikes)) {
countsSp <- fullCountTable[spikes,];
countsGenes <- fullCountTable[-spikes,];
} else {
countsSp <- fullCountTable;
countsGenes <- fullCountTable;
}
meansSp <- rowMeans(countsSp, na.rm=TRUE)
varsSp <- rowVars(countsSp)
cv2Sp <- varsSp/meansSp^2
meansGenes <- rowMeans(countsGenes, na.rm=TRUE)
varsGenes <- rowVars(countsGenes)
cv2Genes <- varsGenes/meansGenes^2
# Fit Model
minMeanForFit <- unname( quantile( meansSp[ which( cv2Sp > 0.3 ) ], fitMeanQuantile))
useForFit <- meansSp >= minMeanForFit
if (sum(useForFit, na.rm=TRUE) < 20) {
warning("Too few spike-ins exceed minMeanForFit, recomputing using all genes.")
meansAll <- c(meansGenes, meansSp)
cv2All <- c(cv2Genes,cv2Sp)
minMeanForFit <- unname( quantile( meansAll[ which( cv2All > 0.3 ) ], 0.80))
useForFit <- meansSp >= minMeanForFit
}
if (sum(useForFit, na.rm=TRUE) < 30) {warning(paste("Only", sum(useForFit), "spike-ins to be used in fitting, may result in poor fit."))}
fit <- glmgam.fit( cbind( a0 = 1.5, a1tilde = 1.1/meansSp[useForFit] ), cv2Sp[useForFit] )
a0 <- unname( fit$coefficients["a0"] )
a1 <- unname( fit$coefficients["a1tilde"])
res <- cv2Genes - (a0 + a1/meansGenes);
# Test
psia1theta <- a1
minBiolDisp <- minBiolDisp^2
m <- ncol(countsSp);
cv2th <- a0 + minBiolDisp + a0 * minBiolDisp
testDenom <- (meansGenes*psia1theta + meansGenes^2*cv2th)/(1+cv2th/m)
p <- 1-pchisq(varsGenes * (m-1)/testDenom,m-1)
padj <- p.adjust(p,"BH")
sig <- padj < fdr
sig[is.na(sig)] <- FALSE
if (!suppress.plot) {
plot( meansGenes,cv2Genes, xaxt="n", yaxt="n", log="xy",
xlab = "average normalized read count",
ylab = "squared coefficient of variation (CV^2)", col="white")
axis( 1, 10^(-2:5), c( "0.01", "0.1", "1", "10", "100", "1000",
expression(10^4), expression(10^5) ) )
axis( 2, 10^(-2:3), c( "0.01", "0.1", "1", "10", "100","1000" ), las=2 )
abline( h=10^(-2:1), v=10^(-1:5), col="#D0D0D0", lwd=2 )
# Plot the genes, use a different color if they are highly variable
#points( meansGenes, cv2Genes, pch=19, cex=.6,
#        col = alpha(ifelse( padj < .1, "blue", colGenes ), 1) )
# Plot/highlight the spike-ins if they are different from the genes
#if (length(meansSp) < length(meansGenes)) {
#  points(meansSp, cv2Sp, pch=20, cex=.5, col=colSp)
#}
# Add the technical noise fit
#xg <- 10^seq( -2, 6, length.out=1000 )
#lines( xg, (a1)/xg + a0, col="red", lwd=3 )
# Add a curve showing the expectation for the chosen biological CV^2 thershold
#lines( xg, psia1theta/xg + a0 + minBiolDisp, lty="dashed", col="purple", lwd=3)
}
TABLE <- data.frame(Gene = names(meansGenes), effect.size=res, p.value = p, q.value= padj, Mean=meansGenes, CV2=cv2Genes ,
TechNoise=(a1)/meansGenes+a0, BioVar=log2(cv2Genes/((a1)/meansGenes+a0)))
TABLE <- TABLE[order(-TABLE[,2]),];
return(list(data=TABLE,A0=a0,A1=a1))
}
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene <- inner_join(CPM_SC18_all_WT_Zscore, gene_types, by="gene") %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - gene) %>%
pivot_wider(names_from = name, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene$NRT2.1, method="spearman")$r) %>%
as.data.frame()
Pcor_NRT2.1_genes <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene$NRT2.1, method="spearman")$p) %>%
as.data.frame()
Rcor_NRT2.1_genes
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
genes_energy <- read_tsv("SC18_data/genes_energy.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Glycolysis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Glycolysis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Glycolysis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Glycolysis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Glycolysis <- inner_join(Rcor_NRT2.1_genes_Glycolysis, Pcor_NRT2.1_genes_Glycolysis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Asp_family_pathway","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Asp_family_pathway <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Asp_family_pathway <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Asp_family_pathway$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Asp_family_pathway <- inner_join(Rcor_NRT2.1_genes_Asp_family_pathway, Pcor_NRT2.1_genes_Asp_family_pathway, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("ATP_biosynthesis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_ATP_biosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_ATP_biosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_ATP_biosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_ATP_biosynthesis <- inner_join(Rcor_NRT2.1_genes_ATP_biosynthesis, Pcor_NRT2.1_genes_ATP_biosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Photosynthesis","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Photosynthesis <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Photosynthesis$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Photosynthesis <- inner_join(Rcor_NRT2.1_genes_Photosynthesis, Pcor_NRT2.1_genes_Photosynthesis, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("TCAcycle_mitocondrialET","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_TCAcycle_mitocondrialET <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_TCAcycle_mitocondrialET$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_TCAcycle_mitocondrialET <- inner_join(Rcor_NRT2.1_genes_TCAcycle_mitocondrialET, Pcor_NRT2.1_genes_TCAcycle_mitocondrialET, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole <- inner_join(CPM_SC18_all_WT_Zscore, genes_energy, by="gene") %>%
filter(type%in%c("Tetrapyrrole","NRT2.1")) %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
inner_join(genes_energy, by="gene")
Pcor_NRT2.1_genes_Tetrapyrrole <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole, function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Tetrapyrrole$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Tetrapyrrole <- inner_join(Rcor_NRT2.1_genes_Tetrapyrrole, Pcor_NRT2.1_genes_Tetrapyrrole, by="gene") %>%
filter(gene!="AT1G08090")
options(scipen=999)
genes_Nnutrition <- read_tsv("SC18_data/Genes_interest.txt")
CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition <- inner_join(CPM_SC18_all_WT_Zscore, genes_Nnutrition, by="gene") %>%
pivot_longer( cols = c(A1:A9), names_to = "seedling", values_to = "Zscore_normalised_expression") %>%
dplyr::select(-type, - name) %>%
pivot_wider(names_from = gene, values_from = Zscore_normalised_expression) %>%
column_to_rownames(var="seedling")
Rcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$r) %>%
as.data.frame() %>%
rownames_to_column(var="gene") %>%
dplyr::rename("Rcor" =".") %>%
mutate(type="Nnutrition")
Pcor_NRT2.1_genes_Nnutrition <- sapply(CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition[-1], function(x) corr.test(x, CPM_SC18_all_WT_Zscore_1ColperGene_Nnutrition$AT1G08090, method="spearman")$p) %>%
as.data.frame()%>%
rownames_to_column(var="gene") %>%
dplyr::rename("Pcor" =".")
Corr_NRT2.1_genes_Nnutrition <- inner_join(Rcor_NRT2.1_genes_Nnutrition, Pcor_NRT2.1_genes_Nnutrition, by="gene") %>%
filter(gene!="AT1G08090")
Corr_NRT2.1_genes_all_groups <- bind_rows(Corr_NRT2.1_genes_Glycolysis, Corr_NRT2.1_genes_Asp_family_pathway, Corr_NRT2.1_genes_ATP_biosynthesis, Corr_NRT2.1_genes_Photosynthesis,Corr_NRT2.1_genes_TCAcycle_mitocondrialET, Corr_NRT2.1_genes_Tetrapyrrole, Corr_NRT2.1_genes_Nnutrition) %>%
mutate(Pthreshold=ifelse(Pcor<0.05, yes="less0.05", no="more0.05"))
Corr_NRT2.1_genes_all_groups
write_tsv(Corr_NRT2.1_genes_all_groups, file="Corr_NRT2.1_genes_all_groups.txt")
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =18) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =18) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18))
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =14) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18))
#AV39 <- read_tsv("influx_biocorp/AV39_influxN15/AV39_influx_luciferase.txt") %>%
mutate(exp="AV39")
#AV39 <- read_tsv("influx_biocorp/AV39_influxN15/AV39_influx_luciferase.txt") %>%
#  mutate(exp="AV39")
AV50 <- read_tsv("influx_biocorp/AV50_influxN15/AV50_influx_luciferase.txt") %>%
mutate(exp="AV50")
AV52 <- read_tsv("influx_biocorp/AV52_InfluxN15/AV52_influx_luciferase.txt") %>%
mutate(exp="AV52")
AV39_9d <- read_tsv("influx_biocorp/AV_39_Influx_10mM/AV_39.2_9j_influx_complet.txt") %>%
mutate(exp="AV39_9d")
AV39_10d <- read_tsv("influx_biocorp/AV_39_Influx_10mM/AV_39.2_10j_influx_complet.txt") %>%
mutate(exp="AV39_10d")
AV39_11d <- read_tsv("influx_biocorp/AV_39_Influx_10mM/AV_39.2_11j_influx_complet.txt") %>%
mutate(exp="AV39_11d")
biocorp_Ninflux <- bind_rows(AV39, AV50, AV52, AV39_9d, AV39_10d, AV39_11d)
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =14) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18))
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =18) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18))
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
filter(exp%in%c("AV39", "AV39_9d")) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =18) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18))
AV50 <- read_tsv("influx_biocorp/AV50_influxN15/AV50_influx_luciferase.txt") %>%
mutate(exp="AV50")
AV52 <- read_tsv("influx_biocorp/AV52_InfluxN15/AV52_influx_luciferase.txt") %>%
mutate(exp="AV52")
AV39_10d <- read_tsv("influx_biocorp/AV_39_Influx_10mM/AV_39.2_10j_influx_complet.txt") %>%
mutate(exp="AV39_10d")
AV50 <- read_tsv("influx_biocorp/AV50_influxN15/AV50_influx_luciferase.txt") %>%
mutate(exp="AV50")
AV52 <- read_tsv("influx_biocorp/AV52_InfluxN15/AV52_influx_luciferase.txt") %>%
mutate(exp="AV52")
AV39_10d <- read_tsv("influx_biocorp/AV39_influxN15/AV_39.2_10j_influx_complet.txt") %>%
mutate(exp="AV39_10d")
biocorp_Ninflux <- bind_rows( AV50, AV52,  AV39_10d)
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =18) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18))
AV39 <- read_tsv("influx_biocorp/AV39_influxN15/AV39_influx_luciferase.txt") %>%
mutate(exp="AV39")
AV52 <- read_tsv("influx_biocorp/AV52_InfluxN15/AV52_influx_luciferase.txt") %>%
mutate(exp="AV52")
biocorp_Ninflux <- bind_rows( AV52,  AV39)
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =18) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18))
AV39 <- read_tsv("influx_biocorp/AV39_influxN15/AV39_influx_luciferase.txt") %>%
mutate(exp="AV39")
AV52 <- read_tsv("influx_biocorp/AV52_InfluxN15/AV52_influx_luciferase.txt") %>%
mutate(exp="AV52")
biocorp_Ninflux <- bind_rows( AV52,  AV39)
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.5, label.x =18) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18)) +
guides(col=FALSE)
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.8, label.x =20) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18)) +
guides(col=FALSE)
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.8, label.x =19) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18)) +
guides(col=FALSE)
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.8, label.x =19) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18)) +
guides(col=FALSE)
ggsave("Correlation_luc_influx_1mM_10mM_biocorp.jpg", width = 6, height = 4)
mutate(biocorp_Ninflux, KNO3=factor(KNO3, levels=c("1mM", "10mM"))) %>%
ggplot( aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=exp)) +
geom_point(size=3) +
stat_cor(method="spearman", size=3.8) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
scale_color_brewer(palette = "Dark2") +
facet_wrap(~KNO3, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 18)) +
guides(col=FALSE)
ggsave("Correlation_luc_influx_1mM_10mM_biocorp.jpg", width = 6, height = 4)
