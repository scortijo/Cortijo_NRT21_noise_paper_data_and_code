header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")),
genotype=factor(genotype, levels = c("pNRT2.1:LUC","swn-3/pNRT2.1:LUC"))) %>%
filter(replicate%in%c("rep1","rep2","rep3"))
luc_reps123_stats <- filter(luc_reps123, seedling!="background") %>%
group_by(genotype, KNO3, replicate)%>%
summarise(average.NormRawIntDen_normLen = mean(RawIntDen_normBackg_normLen,
na.rm = TRUE),
n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/average.NormRawIntDen_normLen) %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
mutate(n=paste("n =",n))
write_tsv(luc_reps123_stats, file="STATS_NRT21_swn3_luc_analysis_reps123.txt")
ggplot(luc_reps123_stats, aes(x=genotype, y=CV, group=replicate, color=replicate)) +
geom_point(size=6) +
facet_grid(~KNO3)+
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 16)) +
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 0.2,
label.y = 0.8, comparisons = list(c("swn-3/pNRT2.1:LUC", "pNRT2.1:LUC")))
stat_compare_means(method = "t.test",paired = TRUE,  comparisons = list(c("swn-3/pNRT2.1:LUC", "pNRT2.1:LUC")))
luc_stats_reps <- read.table("STATS_NRT21_swn3_luc_analysis_reps123.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")),
genotype=factor(genotype, levels = c("pNRT2.1:LUC","swn-3/pNRT2.1:LUC")))
ggplot(luc_stats_reps, aes(x=genotype, y=CV)) +
geom_point(aes( color=replicate), size=8) +
ggtitle("Comparison CV swn3/pNRT2.1:luc reps123")+
geom_line(aes(group=replicate), col="grey", linetype="dotted") +
facet_grid(~KNO3)+
scale_color_brewer(palette="Dark2", labels=c("rep1"="rep1","rep2"="rep2",
"rep3"="rep3")) +
ylim(0,0.9) +
ylab(expression(paste("CV for ", italic("pNRT2.1:LUC"), " signal"))) +
theme(legend.text=element_text(size=20),
legend.title = element_text(size=22, face="bold"),
axis.text=element_text(size=20),
axis.title=element_text(size=22),
plot.title = element_text(size=20,face="bold", hjust=0,5),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 20)) +
stat_compare_means(label="p.format", method = "wilcox.test",  paired = TRUE,
label.x = 1.4,
label.y = 0.8) +
scale_x_discrete(labels=c("pNRT2.1:LUC" = "WT", "swn-3/pNRT2.1:LUC" = expression(italic("swn-3"))))
ggplot(luc_stats_reps, aes(x=genotype, y=CV)) +
geom_point(aes( color=replicate), size=8) +
ggtitle("Comparison CV swn-3/pNRT2.1:luc reps123")+
geom_line(aes(group=replicate), col="grey", linetype="dotted") +
facet_grid(~KNO3)+
scale_color_brewer(palette="Dark2", labels=c("rep1"="rep1","rep2"="rep2",
"rep3"="rep3")) +
ylim(0,0.9) +
ylab(expression(paste("CV for ", italic("pNRT2.1:LUC"), " signal"))) +
theme(legend.text=element_text(size=20),
legend.title = element_text(size=22, face="bold"),
axis.text=element_text(size=20),
axis.title=element_text(size=22),
plot.title = element_text(size=20,face="bold", hjust=0,5),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 20)) +
stat_compare_means(label="p.format", method = "wilcox.test",  paired = TRUE,
label.x = 1.4,
label.y = 0.8) +
scale_x_discrete(labels=c("pNRT2.1:LUC" = "WT", "swn-3/pNRT2.1:LUC" = expression(italic("swn-3"))))
ggsave("Comparison_CV_reps123_swn3_pNRT21.jpg")
luc <- read.table("AV_12_swn3pNRT21.luc_all_rep.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3, replicate)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
QCD=(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))-
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))/
(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))+
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))) %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV", round(CV,2)),
QCD=paste("", round(QCD,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "swn-3/pNRT2.1:LUC" ))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=replicate.x, y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 100, position = position_dodge(0.8))+
facet_grid(~KNO3.x, scales= "free")+
scale_fill_manual(values = c("#00AFBB", "#FF6633"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("swn-3/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#CB2027"))+
geom_text(aes(label=n , x=replicate.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=replicate.x, y=11000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=replicate.x, y=10000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal \n (Raw integrated density normalisez by leng root)") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=replicate.x, y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 100, position = position_dodge(0.8))+
facet_grid(~KNO3.x, scales= "free")+
scale_fill_manual(values = c("#00AFBB", "#FF6633"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("swn-3/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#FF6633"))+
geom_text(aes(label=n , x=replicate.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=replicate.x, y=11000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=replicate.x, y=10000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal \n (Raw integrated density normalisez by leng root)") +
guides(col="none")
ggsave("RawIntDen_normBackg_normLen_swn_all_replicate.jpg")
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/AV_13_lhp1-4_pNRT21_LUC/")
luc_reps <- read.table("AV_13_lhp1_4_all_reps.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")),
genotype=factor(genotype, levels = c("pNRT2.1:LUC","lhp1-4/pNRT2.1:LUC")))
luc_reps_stats <- filter(luc_reps, seedling!="background") %>%
group_by(genotype, KNO3, replicate)%>%
summarise(average.NormRawIntDen_normLen = mean(RawIntDen_normBackg_normLen,
na.rm = TRUE),
n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/average.NormRawIntDen_normLen) %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
mutate(n=paste("n =",n))
luc_reps123 <- read.table("AV_13_lhp1_4_all_reps.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")),
genotype=factor(genotype, levels = c("pNRT2.1:LUC","lhp1-4/pNRT2.1:LUC"))) %>%
filter(replicate%in%c("rep1","rep2", "rep3"))
luc_reps123_stats <- filter(luc_reps123, seedling!="background") %>%
group_by(genotype, KNO3, replicate)%>%
summarise(average.NormRawIntDen_normLen = mean(RawIntDen_normBackg_normLen,
na.rm = TRUE),
n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/average.NormRawIntDen_normLen) %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
mutate(n=paste("n =",n))
write_tsv(luc_reps123_stats, file="STATS_NRT21_lhp1_4_luc_analysis_reps123.txt")
ggplot(luc_reps123_stats, aes(x=genotype, y=CV, group=replicate, color=replicate)) +
geom_point(size=6) +
facet_grid(~KNO3)+
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 16)) +
stat_compare_means( method = "wilcox.test", paired = TRUE,
label.x = 0.2,
label.y = 0.8, comparisons = list(c("lhp1-4/pNRT2.1:LUC", "pNRT2.1:LUC")))
luc_stats_reps <- read.table("STATS_NRT21_lhp1_4_luc_analysis_reps123.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")),
genotype=factor(genotype, levels = c("pNRT2.1:LUC","lhp1-4/pNRT2.1:LUC")))
ggplot(luc_stats_reps, aes(x=genotype, y=CV)) +
geom_point(aes( color=replicate), size=8) +
ggtitle("Comparison CV lhp1-4/pNRT2.1:LUC reps123")+
geom_line(aes(group=replicate), col="grey", linetype="dotted") +
facet_grid(~KNO3)+
scale_color_brewer(palette="Dark2", labels=c("rep1"="rep1","rep2"="rep2" ,"rep3"="rep3")) +
ylim(0,0.9) +
ylab(expression(paste("CV for ", italic("pNRT2.1:LUC"), " signal"))) +
theme(legend.text=element_text(size=20),
legend.title = element_text(size=22, face="bold"),
axis.text=element_text(size=20),
axis.title=element_text(size=22),
plot.title = element_text(size=20,face="bold", hjust=0,5),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"),
strip.text.x = element_text(size = 20)) +
scale_x_discrete(labels=c("pNRT2.1:LUC" = "WT",
"lhp1-4/pNRT2.1:LUC" = expression(italic("lhp1-4"))))+
stat_compare_means(method = "wilcox.test",paired = TRUE,
abel.x = 0.2,
label.y = 0.8,
comparisons = list(c("lhp1-4/pNRT2.1:LUC", "pNRT2.1:LUC")))
ggsave("Comparison_CV_reps123_lhp1_4_pNRT21.jpg")
luc <- read.table("AV_13_lhp1_4_all_reps.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3, replicate)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
QCD=(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))-
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))/
(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))+
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))) %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
mutate(n=paste("n=",n),
CV=paste("CV", round(CV,2)),
QCD=paste("", round(QCD,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "lhp1-4/pNRT2.1:LUC" ))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=replicate.x, y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 100, position = position_dodge(0.8))+
facet_grid(~KNO3.x, scales= "free")+
scale_fill_manual(values = c("#00AFBB", "#9933FF"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("lhp1-4/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#9933FF"))+
geom_text(aes(label=n , x=replicate.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=replicate.x, y=11000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=replicate.x, y=10000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal \n (Raw integrated density normalisez by leng root)") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=replicate.x, y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 100, position = position_dodge(0.8))+
facet_grid(~KNO3.x, scales= "free")+
scale_fill_manual(values = c("#00AFBB", "#9933FF"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("lhp1-4/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#9933FF"))+
geom_text(aes(label=n , x=replicate.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=replicate.x, y=11000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=replicate.x, y=10000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(replicate)) +
ylab("Luciferase signal") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=replicate.x, y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 100, position = position_dodge(0.8))+
facet_grid(~KNO3.x, scales= "free")+
scale_fill_manual(values = c("#00AFBB", "#9933FF"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("lhp1-4/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#9933FF"))+
geom_text(aes(label=n , x=replicate.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=replicate.x, y=11000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=replicate.x, y=10000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab("replicate") +
ylab("Luciferase signal") +
guides(col="none")
ggsave("RawIntDen_normBackg_normLen_lhp1_4_all_replicate.jpg")
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/AV_12_swn-3_pNRT2.1.luc/")
luc <- read.table("AV_12_swn3pNRT21.luc_all_rep.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3, replicate)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
QCD=(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))-
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))/
(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))+
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))) %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV", round(CV,2)),
QCD=paste("", round(QCD,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "swn-3/pNRT2.1:LUC" ))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=replicate.x, y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 100, position = position_dodge(0.8))+
facet_grid(~KNO3.x, scales= "free")+
scale_fill_manual(values = c("#00AFBB", "#FF6633"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("swn-3/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#FF6633"))+
geom_text(aes(label=n , x=replicate.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=replicate.x, y=11000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=replicate.x, y=10000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal \n (Raw integrated density normalisez by leng root)") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, replicate, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=replicate.x, y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 100, position = position_dodge(0.8))+
facet_grid(~KNO3.x, scales= "free")+
scale_fill_manual(values = c("#00AFBB", "#FF6633"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("swn-3/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#FF6633"))+
geom_text(aes(label=n , x=replicate.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=replicate.x, y=11000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=replicate.x, y=10000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
xlab("replicate") +
ylab("Luciferase signal") +
guides(col="none")
ggsave("RawIntDen_normBackg_normLen_swn_all_replicate.jpg")
setwd("/Users/vettoral/Documents/luciferase_imaging_horizontal/AV_26_LBD_pNRT21_luc/20230413_LBD_rep4/")
getwd()
library(tidyverse)
library(scales)
luc <- read.table("AV_26_rep4_LBD_9J_influx.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
luc <- read.table("AV_26_rep4_LBD_9J_influx.txt",
header=TRUE, sep='\t') %>%
mutate(KNO3=factor(KNO3, levels = c("1mM","10mM")))
View(luc)
luc_stats <- filter(luc, seedling!="background") %>%
group_by(genotype, KNO3)%>%
summarise(n=n(),
CV=sd(RawIntDen_normBackg_normLen,
na.rm = TRUE)/ mean(RawIntDen_normBackg_normLen, na.rm = TRUE),
QCD=(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))-
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))/
(as.numeric(quantile(RawIntDen_normBackg_normLen, 0.75, na.rm = TRUE))+
as.numeric(quantile(RawIntDen_normBackg_normLen, 0.25, na.rm = TRUE)))) %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
mutate(n=paste("n =",n),
CV=paste("CV =", round(CV,2)),
QCD=paste("QCD =", round(QCD,2)))
luc$genotype <- fct_relevel(luc$genotype, c("pNRT2.1:LUC", "LBD/pNRT2.1:LUC" ))
levels(luc$genotype)
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 250, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3.x, y=8000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=KNO3.x, y=9000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 6000)+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal (Raw integrated density)") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 150, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3.x, y=8000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=KNO3.x, y=9000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 6000)+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal (Raw integrated density)") +
guides(col="none")
filter(luc, seedling!="background") %>%
unite(Sample, genotype, KNO3, remove=FALSE) %>%
full_join(luc_stats, by="Sample") %>%
ggplot( aes(x=KNO3.x , y=RawIntDen_normBackg_normLen, col=genotype.x))+
geom_boxplot(aes(color = genotype.x), width = 0.5, position = position_dodge(0.8),
outlier.shape = NA) +
geom_dotplot(aes(fill = genotype.x, color = genotype.x), binaxis='y', stackdir='center',
dotsize = 1, binwidth = 200, position = position_dodge(0.8))+
scale_fill_manual(values = c("#00AFBB", "#006600"), name="genotype",
labels=c(expression(italic("pNRT2.1:LUC")),
expression(italic("LBD/pNRT2.1:LUC"))))+
scale_color_manual(values = c("#00AFBB", "#006600"))+
geom_text(aes(label=n , x=KNO3.x, y=-1000 ),position=position_dodge(0.8)) +
geom_text(aes(label=CV , x=KNO3.x, y=8000 ),position=position_dodge(0.8)) +
geom_text(aes(label=QCD , x=KNO3.x, y=9000 ),position=position_dodge(0.8)) +
theme(legend.text=element_text(size=16),
legend.title = element_text(size=18, face="bold"),
axis.text=element_text(size=16),
axis.title=element_text(size=18),
plot.title = element_text(size=20,face="bold"),
legend.key = element_rect(fill = "white"),
legend.title.align=0.5,
panel.background = element_rect(fill = "white", colour = "grey50"))+
stat_compare_means(label="p.format", method = "wilcox.test",
label.x = 30,
label.y = 6000)+
xlab(expression(KNO[3]~concentration)) +
ylab("Luciferase signal (Raw integrated density)") +
guides(col="none")
ggsave("RawIntDen_normBackg_normLen_AV_26_9J_influx_rep4.jpg")
