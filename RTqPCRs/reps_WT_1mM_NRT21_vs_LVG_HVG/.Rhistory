knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
CV_all <- bind_rows(CV_AR1267, CV_AR1277, CV_AV10, CV_AV3, CV_AV32, CV_SC18, CV_SC24)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
AV3 <- read_tsv("AV3_RtqPCR_luc_1mM.txt") %>%
mutate(expt="AV3")
CV_AV3 <- group_by(AV3, expt, Primers, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primers, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(CV= sd(PercControls)/mean(PercControls)) %>%
mutate(expt="AV3")
CV_AV3
AV10_plate1 <- read_tsv("AV10_RtqPCR_WT_1mM_plate1.txt") %>%
mutate(expt="AV10")
AV10_plate2 <- read_tsv("AV10_RtqPCR_WT_1mM_plate2.txt") %>%
mutate(expt="AV10")
AV10 <- bind_rows(AV10_plate1, AV10_plate2)
CV_AV10 <- group_by(AV10, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(CV= sd(PercControls)/mean(PercControls)) %>%
mutate(expt="AV10")
CV_AV10
AV32_plate1 <- read_tsv("AV32_RtqPCR_luc_1mM_plate1.txt") %>%
mutate(expt="AV32")
AV32_plate2 <- read_tsv("AV32_RtqPCR_luc_1mM_plate2.txt") %>%
mutate(expt="AV32")
AV32 <- bind_rows(AV32_plate1, AV32_plate2)
CV_AV32 <- group_by(AV32, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(CV= sd(PercControls)/mean(PercControls)) %>%
mutate(expt="AV32")
CV_AV32
AR1267_plate1 <- read_tsv("AR1267_RtqPCR_luc_1mM_plate1.txt") %>%
mutate(expt="AR1267")
AR1267_plate2 <- read_tsv("AR1267_RtqPCR_luc_1mM_plate2.txt") %>%
mutate(expt="AR1267")
AR1267 <- bind_rows(AR1267_plate1, AR1267_plate2)
CV_AR1267 <- group_by(AR1267, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(SandF, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-UBQ10))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(CV= sd(PercControls)/mean(PercControls)) %>%
mutate(expt="AR1267")
CV_AR1267
AR1277_plate1 <- read_tsv("AR1277_RtqPCR_luc_1mM_plate1.txt") %>%
mutate(expt="AR1277")
AR1277_plate2 <- read_tsv("AR1277_RtqPCR_luc_1mM_plate2.txt") %>%
mutate(expt="AR1277")
AR1277_plate3 <- read_tsv("AR1277_RtqPCR_luc_1mM_plate3.txt") %>%
mutate(expt="AR1277")
AR1277 <- bind_rows(AR1277_plate1, AR1277_plate2, AR1277_plate3)
CV_AR1277 <- group_by(AR1277, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(CV= sd(PercControls)/mean(PercControls)) %>%
mutate(expt="AR1277")
CV_AR1277
SC18_plate1 <- read_tsv("SC18_RtqPCR_WT_1mM_plate1.txt") %>%
mutate(expt="SC18")
SC18_plate2 <- read_tsv("SC18_RtqPCR_WT_1mM_plate2.txt") %>%
mutate(expt="SC18")
SC18 <- bind_rows(SC18_plate1, SC18_plate2)
CV_SC18 <- group_by(SC18, expt, Primers, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primers, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(CV= sd(PercControls)/mean(PercControls)) %>%
mutate(expt="SC18")
CV_SC18
SC24_plate1 <- read_tsv("SC24_RtqPCR_WT_1mM_plate1.txt") %>%
mutate(expt="SC24")
SC24_plate2 <- read_tsv("SC24_RtqPCR_WT_1mM_plate2.txt") %>%
mutate(expt="SC24")
SC24 <- bind_rows(SC24_plate1, SC24_plate2)
CV_SC24 <- group_by(SC24, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup()  %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(CV= sd(PercControls)/mean(PercControls)) %>%
mutate(expt="SC24")
CV_SC24
group_by(AV3, expt, Primers, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primers, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(nb= n())
CV_AV10 <- group_by(AV10, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(nb= n())
group_by(AV10, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(nb= n())
AV10_plate1 <- read_tsv("AV10_RtqPCR_WT_1mM_plate1.txt") %>%
mutate(expt="AV10")
AV10_plate2 <- read_tsv("AV10_RtqPCR_WT_1mM_plate2.txt") %>%
mutate(expt="AV10")
AV10 <- bind_rows(AV10_plate1, AV10_plate2)
CV_AV10 <- group_by(AV10, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(CV= sd(PercControls)/mean(PercControls)) %>%
mutate(expt="AV10")
group_by(AV10, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(nb= n())
CV_AV10
group_by(AV32, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(nb= n())
group_by(AR1267, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(SandF, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-UBQ10))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(nb= n())
group_by(AR1277, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(nb= n())
group_by(SC18, expt, Primers, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primers, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup() %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(nb= n())
group_by(SC24, expt, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
ungroup()  %>%
mutate_at(c("HVG", "LVG", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
pivot_longer(cols=c(HVG_PercControl:NRT2.1_PercControl), names_to = "Gene", values_to = "PercControls") %>%
group_by(Gene) %>%
summarise(nb= n())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
T0 <- read_tsv("20230724_AV_30_T0_6J/20230724_AV_30_T0_6J.txt")
T1 <- read_tsv("20230725_AV_30_T1_7J/20230724_AV_30_T1_7J.txt")
T2 <- read_tsv("20230726_AV_30_T2_8J/20230726_AV_30_T2_8J.txt")
T3 <- read_tsv("20230727_AV_30_T3_9J/20230727_AV_30_T3_9J.txt")
T4 <- read_tsv("20230728_AV_30_T4_10J/20230727_AV_30_T4_10J.txt")
T5 <- read_tsv("20230729_AV_30_T5_11J/20230729_AV_30_T5_11J.txt")
T6 <- read_tsv("20230730_AV_30_T6_12J/20230730_AV_30_T6_12J.txt")
All_time_points_starvation <- bind_rows(T0, T1, T2, T3, T4, T5, T6)
All_time_points_starvation_norm <- mutate(All_time_points_starvation, RawIntDenDivArea=RawIntDen/area) %>%
filter(seedling=="background") %>%
group_by( KNO3, PLATE, DAY) %>%
summarise(MeanBack=mean(RawIntDenDivArea)) %>%
full_join(All_time_points_starvation, by=c("KNO3"="KNO3", "PLATE"="PLATE", "DAY"="DAY")) %>%
mutate(RawIntDen_NormBack= RawIntDen-(MeanBack*area)) %>%
mutate(root_length_mm= length/4.95,
RawIntDen_NormBack_NormLen=RawIntDen_NormBack/root_length_mm) %>%
filter(seedling!="background")
group_by(All_time_points_starvation_norm, KNO3, DAY) %>%
summarise(CV=sd(RawIntDen_NormBack_NormLen)/mean(RawIntDen_NormBack_NormLen)) %>%
mutate(days=str_replace(DAY, "T", "")) %>%
ggplot(aes(x=days, y=CV, group=KNO3, color=KNO3)) +
geom_line(size=2) +
geom_vline(xintercept=1.3, col="grey", linetype="dashed") +
geom_vline(xintercept=5.3, col="grey", linetype="dashed") +
xlab("Days since the first transfer") +
ylab(expression(paste("CV for ", italic("NRT2.1:LUC"), " signal"))) +
ylim(0,0.65) +
scale_color_brewer(palette="Dark2") +
guides(color = guide_legend(title = bquote('KNO'[3]*' treatment'))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("CV_Starvation.jpg", height = 4, width=7.3)
group_by(All_time_points_starvation_norm, KNO3, DAY) %>%
summarise(Mean_signal=mean(RawIntDen_NormBack_NormLen),
lowsd=Mean_signal-sd(RawIntDen_NormBack_NormLen),
highsd=Mean_signal+sd(RawIntDen_NormBack_NormLen)) %>%
mutate(days=str_replace(DAY, "T", "")) %>%
ggplot(aes(x=days, y=Mean_signal, group=KNO3)) +
geom_line(aes(col=KNO3), size=1.5, linetype="twodash") +
geom_ribbon(aes(ymin=lowsd, ymax=highsd, fill=KNO3), alpha=0.2) +
geom_vline(xintercept=1.3, col="grey", linetype="dashed") +
geom_vline(xintercept=5.3, col="grey", linetype="dashed") +
ylab(expression(paste(italic("NRT2.1:LUC"), " luciferase signal"))) +
xlab("Days since the first transfer") +
scale_color_brewer(palette="Dark2") +
guides(fill ="none") +
guides(color = guide_legend(title = bquote('KNO'[3]*' treatment'))) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Mean_Starvation.jpg", height = 4, width=7.37)
select(All_time_points_starvation_norm, "KNO3", "PLATE", "DAY", "seedling", "RawIntDen_NormBack_NormLen" ) %>%
filter(KNO3=="1mM->0mM->1mM") %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_NormBack_NormLen") %>%
ggplot(aes(x=T0, y=T4)) +
geom_point()+
xlab("Luciferase signal before starvation") +
ylab("luciferase signal during starvation") +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_before_during_starvation.jpg", height = 4.5, width=5)
select(All_time_points_starvation_norm, "KNO3", "PLATE", "DAY", "seedling", "RawIntDen_NormBack_NormLen" ) %>%
filter(KNO3=="1mM->0mM->1mM") %>%
pivot_wider(names_from = "DAY", values_from = "RawIntDen_NormBack_NormLen") %>%
ggplot(aes(x=T0, y=T5)) +
geom_point()+
xlab("Luciferase signal before starvation") +
ylab("luciferase signal after starvation") +
stat_cor(method="spearman", size=5) +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Correlation_before_after_starvation.jpg", height = 4.5, width=5)
filter(All_time_points_starvation_norm, KNO3=="1mM->1mM->1mM", DAY!="T0") %>%
mutate(days=str_replace(DAY, "T", "")) %>%
mutate(days=as.numeric(days)+6) %>%
ggplot(aes(x=days, y=RawIntDen_NormBack_NormLen, group=seedling)) +
geom_line(size=0.8) +
geom_vline(xintercept=10.3, col="blue", linetype="dashed") +
ylab(expression(paste(italic("NRT2.1:LUC"), " luciferase signal"))) +
xlab("Age of plants (days)") +
facet_wrap(~PLATE, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Signal_seedlings_control_starvationExp.jpg", width = 8, height = 4)
