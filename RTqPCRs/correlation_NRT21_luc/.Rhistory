theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
group_by(RTqPCR_allPlates,expt, plate, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
select(-HVG, -LVG) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
mutate_at(c( "LUC", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
ggplot(aes(x=LUC_PercControl, y=NRT2.1_PercControl)) +
geom_point(size=2.5) +
xlab("Normalised expression for *LUC* <br>measured by RT-qPCR")
group_by(RTqPCR_allPlates,expt, plate, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
select(-HVG, -LVG) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
mutate_at(c( "LUC", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
ggplot(aes(x=LUC_PercControl, y=NRT2.1_PercControl)) +
geom_point(size=2.5) +
xlab(str_wrap(expression(paste("Normalised expression for ",italic("LUC"), " <br>measured by RT-qPCR")))) +
ylab(expression(paste("Normalised expression for ",italic("NRT2.1"), " measured by RT-qPCR"))) +
stat_cor(size=6) +
facet_wrap(.~expt, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
?expression
group_by(RTqPCR_allPlates,expt, plate, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
select(-HVG, -LVG) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
mutate_at(c( "LUC", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
ggplot(aes(x=LUC_PercControl, y=NRT2.1_PercControl)) +
geom_point(size=2.5) +
xlab(expression(atop(paste("Normalised expression for ",italic("LUC")), expression("measured by RT-qPCR")))) +
ylab(expression(paste("Normalised expression for ",italic("NRT2.1"), " measured by RT-qPCR"))) +
stat_cor(size=6) +
facet_wrap(.~expt, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
group_by(RTqPCR_allPlates,expt, plate, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
select(-HVG, -LVG) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
mutate_at(c( "LUC", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
ggplot(aes(x=LUC_PercControl, y=NRT2.1_PercControl)) +
geom_point(size=2.5) +
xlab(expression(atop(paste("Normalised expression for ",italic("LUC")), "measured by RT-qPCR"))) +
ylab(expression(paste("Normalised expression for ",italic("NRT2.1"), " measured by RT-qPCR"))) +
stat_cor(size=6) +
facet_wrap(.~expt, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
group_by(RTqPCR_allPlates,expt, plate, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
select(-HVG, -LVG) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
mutate_at(c( "LUC", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
ggplot(aes(x=LUC_PercControl, y=NRT2.1_PercControl)) +
geom_point(size=2.5) +
xlab(expression(atop(paste("Normalised expression for ",italic("LUC")), "measured by RT-qPCR"))) +
ylab(expression(atop(paste("Normalised expression for ",italic("NRT2.1")), "measured by RT-qPCR"))) +
stat_cor(size=6) +
facet_wrap(.~expt, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
library(ggtext)
group_by(RTqPCR_allPlates,expt, plate, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
select(-HVG, -LVG) %>%
rowwise() %>%
mutate(MeanControls=mean(c(ACT2, UBQ10), na.rm = TRUE)) %>%
mutate_at(c( "LUC", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
ggplot(aes(x=LUC_PercControl, y=NRT2.1_PercControl)) +
geom_point(size=2.5) +
xlab(expression(atop(paste("Normalised expression for ",italic("LUC")), "measured by RT-qPCR"))) +
ylab(expression(atop(paste("Normalised expression for ",italic("NRT2.1")), "measured by RT-qPCR"))) +
stat_cor(size=6) +
facet_wrap(.~expt, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
ggsave("Correlation_NRT2.1_LUC_2reps.jpg", height = 4.5, width = 7)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
#rep1
MO1 <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/MO1_transgenerational/Mo_01_20230418.txt")
MO2 <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/MO2_transgenerational/Mo_02_20230424.txt")
MO3 <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/MO3_transgenerational/Mo_03_20230512.txt")
rep1 <- bind_rows(MO1,MO2 ,MO3) %>%
mutate(expt="rep1")
#rep2
SC48 <- read_tsv("rep2_SC48_SC49_transgenerational/SC48_transgenerational/SC48_TransGen_luc_signal.txt")
SC49 <- read_tsv("rep2_SC48_SC49_transgenerational/SC49_transgenerational/SC49_transGenerational_luc_signal.txt")
rep2 <- bind_rows(SC48,SC49 ) %>%
mutate(expt="rep2")
rep1_2 <- rbind(rep1,rep2)
rep1_2_norm <- mutate(rep1_2, RawIntDenDivArea=RawIntDen/area) %>%
filter(seedling=="background") %>%
group_by(genotype, plate, expt) %>%
summarise(MeanBack=mean(RawIntDenDivArea)) %>%
full_join(rep1_2, by=c("genotype"="genotype", "plate"="plate", "expt"="expt")) %>%
mutate(RawIntDen_NormBack= RawIntDen-(MeanBack*area)) %>%
mutate(root_length_mm= length/4,
RawIntDen_NormBack_NormLen=RawIntDen_NormBack/root_length_mm) %>%
filter(seedling!="background")
rep1_parents <- read_tsv("rep1_MO1_MO2_MO3_transgenerational/Rep1_parents_transgenerational_selection/Rep1_parents_transgenerational_selection.txt") %>%
mutate(expt="rep1")
rep2_parents <- read_tsv("rep2_SC48_SC49_transgenerational/Rep2_parents_transgenerational_selection/Rep2_parents_transgenerational_selection.txt") %>%
mutate(expt="rep2")
rep1_2_parents <- rbind(rep1_parents,rep2_parents)
# Normalisation of signal by the background and root length
rep1_2_parents_norm <- mutate(rep1_2_parents, RawIntDenDivArea_Parent=RawIntDen_Parent/area_Parent) %>%
filter(seedling_Parent=="background") %>%
group_by(genotype_Parent, PLATE_Parent, expt) %>%
summarise(MeanBack_Parent=mean(RawIntDenDivArea_Parent)) %>%
full_join(rep1_2_parents, by=c("genotype_Parent"="genotype_Parent", "PLATE_Parent"="PLATE_Parent", "expt"="expt")) %>%
mutate(RawIntDen_NormBack_Parent= RawIntDen_Parent-(MeanBack_Parent*area_Parent)) %>%
mutate(root_length_mm_Parent= length_Parent/4,
RawIntDen_NormBack_NormLen_Parent=RawIntDen_NormBack_Parent/root_length_mm_Parent) %>%
filter(seedling_Parent!="background")
parents_col <- c(brewer.pal(n = 3, name = "Dark2"), "grey")
filter(rep1_2_parents_norm, expt=="rep1") %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high", "other"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, col=type_Parent)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_manual(values=parents_col, name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other") %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, col=type_Parent)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_manual(values=parents_col, name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
parents_col <- c(brewer.pal(n = 3, name = "Dark2"))
filter(rep1_2_parents_norm, expt=="rep1", type_Parent!="other") %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, col=type_Parent)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_manual(values=parents_col, name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep1_transGen.jpg",height = 3.5, width = 4)
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other") %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, col=type_Parent)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_manual(values=parents_col, name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
parents_col <- c(brewer.pal(n = 3, name = "Dark2"))
filter(rep1_2_parents_norm, expt=="rep2", type_Parent!="other") %>%
mutate(type_Parent=factor(type_Parent, levels=c("low", "medium", "high"))) %>%
ggplot(aes(x=genotype_Parent, y=RawIntDen_NormBack_NormLen_Parent, col=type_Parent)) +
geom_point(size=3) +
ylab(expression(paste(italic("NRT2.1:LUC")," signal of parents"))) +
xlab("") +
scale_color_manual(values=parents_col, name="Type of parent") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"))
ggsave("Selection_parents_rep2_transGen.jpg",height = 3.5, width = 4)
knitr::opts_chunk$set(echo = TRUE)
gene_types <- read_tsv("SC18_data/Genes_interest.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
library(tidyverse)
library(matrixStats)
library(statmod)
library(scTenifoldNet)
library(RColorBrewer)
library(gplots)
library(topGO)
library(psych)
library(ggpubr)
gene_types <- read_tsv("SC18_data/Genes_interest.txt")
SC18_all_WT <- read_tsv("SC18_data/SC18_Raw_HTSeq_WT.txt") %>%
column_to_rownames(var="gene")
CPMnorm_SC18_all_WT <- cpmNormalization(SC18_all_WT)
CPM_SC18_all_WT <- as.data.frame.matrix(CPMnorm_SC18_all_WT)
CPM_SC18_all_WT_Zscore <- mutate_all(CPM_SC18_all_WT, funs("Zscore" = (.-rowMeans(CPM_SC18_all_WT[,1:24], na.rm=TRUE))/rowSds(as.matrix(CPM_SC18_all_WT[,1:24])))) %>%
dplyr::select( contains("Zscore")) %>%
rename_with(~ gsub("_Zscore", "", .x, fixed = TRUE)) %>%
rownames_to_column(var="gene")
BrenneckeGetVariableGenesMod <- function(expr_mat, spikes=NA, suppress.plot=FALSE, fdr=0.1, minBiolDisp=0.5, fitMeanQuantile=0.8) {
#require(statmod)
rowVars <- function(x) { unlist(apply(x,1,var, na.rm=TRUE))}
colGenes <- "black"
colSp <- "blue"
fullCountTable <- expr_mat;
if (is.character(spikes)) {
sp <- rownames(fullCountTable) %in% spikes;
countsSp <- fullCountTable[sp,];
countsGenes <- fullCountTable[!sp,];
} else if (is.numeric(spikes)) {
countsSp <- fullCountTable[spikes,];
countsGenes <- fullCountTable[-spikes,];
} else {
countsSp <- fullCountTable;
countsGenes <- fullCountTable;
}
meansSp <- rowMeans(countsSp, na.rm=TRUE)
varsSp <- rowVars(countsSp)
cv2Sp <- varsSp/meansSp^2
meansGenes <- rowMeans(countsGenes, na.rm=TRUE)
varsGenes <- rowVars(countsGenes)
cv2Genes <- varsGenes/meansGenes^2
# Fit Model
minMeanForFit <- unname( quantile( meansSp[ which( cv2Sp > 0.3 ) ], fitMeanQuantile))
useForFit <- meansSp >= minMeanForFit
if (sum(useForFit, na.rm=TRUE) < 20) {
warning("Too few spike-ins exceed minMeanForFit, recomputing using all genes.")
meansAll <- c(meansGenes, meansSp)
cv2All <- c(cv2Genes,cv2Sp)
minMeanForFit <- unname( quantile( meansAll[ which( cv2All > 0.3 ) ], 0.80))
useForFit <- meansSp >= minMeanForFit
}
if (sum(useForFit, na.rm=TRUE) < 30) {warning(paste("Only", sum(useForFit), "spike-ins to be used in fitting, may result in poor fit."))}
fit <- glmgam.fit( cbind( a0 = 1.5, a1tilde = 1.1/meansSp[useForFit] ), cv2Sp[useForFit] )
a0 <- unname( fit$coefficients["a0"] )
a1 <- unname( fit$coefficients["a1tilde"])
res <- cv2Genes - (a0 + a1/meansGenes);
# Test
psia1theta <- a1
minBiolDisp <- minBiolDisp^2
m <- ncol(countsSp);
cv2th <- a0 + minBiolDisp + a0 * minBiolDisp
testDenom <- (meansGenes*psia1theta + meansGenes^2*cv2th)/(1+cv2th/m)
p <- 1-pchisq(varsGenes * (m-1)/testDenom,m-1)
padj <- p.adjust(p,"BH")
sig <- padj < fdr
sig[is.na(sig)] <- FALSE
if (!suppress.plot) {
plot( meansGenes,cv2Genes, xaxt="n", yaxt="n", log="xy",
xlab = "average normalized read count",
ylab = "squared coefficient of variation (CV^2)", col="white")
axis( 1, 10^(-2:5), c( "0.01", "0.1", "1", "10", "100", "1000",
expression(10^4), expression(10^5) ) )
axis( 2, 10^(-2:3), c( "0.01", "0.1", "1", "10", "100","1000" ), las=2 )
abline( h=10^(-2:1), v=10^(-1:5), col="#D0D0D0", lwd=2 )
# Plot the genes, use a different color if they are highly variable
#points( meansGenes, cv2Genes, pch=19, cex=.6,
#        col = alpha(ifelse( padj < .1, "blue", colGenes ), 1) )
# Plot/highlight the spike-ins if they are different from the genes
#if (length(meansSp) < length(meansGenes)) {
#  points(meansSp, cv2Sp, pch=20, cex=.5, col=colSp)
#}
# Add the technical noise fit
#xg <- 10^seq( -2, 6, length.out=1000 )
#lines( xg, (a1)/xg + a0, col="red", lwd=3 )
# Add a curve showing the expectation for the chosen biological CV^2 thershold
#lines( xg, psia1theta/xg + a0 + minBiolDisp, lty="dashed", col="purple", lwd=3)
}
TABLE <- data.frame(Gene = names(meansGenes), effect.size=res, p.value = p, q.value= padj, Mean=meansGenes, CV2=cv2Genes ,
TechNoise=(a1)/meansGenes+a0, BioVar=log2(cv2Genes/((a1)/meansGenes+a0)))
TABLE <- TABLE[order(-TABLE[,2]),];
return(list(data=TABLE,A0=a0,A1=a1))
}
CPM_SC18_all_WT_expr <-  filter(CPM_SC18_all_WT, rowMeans(CPM_SC18_all_WT[,1:24])>=5&
rowSums(CPM_SC18_all_WT[1:22]<0.0001)<5)
Gene_size <- read_tsv("SC18_data/TAIR10_Gene_sizes.txt") %>%
dplyr::select(gene_name,length)
Genes_more150bp <-filter(Gene_size,length>150)
CPM_SC18_all_WT_expr <- rownames_to_column(CPM_SC18_all_WT_expr, var="gene") %>%
inner_join( Genes_more150bp, by=c("gene"="gene_name")) %>%
dplyr::select(-length) %>%
column_to_rownames(var="gene") %>%
as.data.frame()
CPM_SC18_all_WT_expr_Brennecke <- BrenneckeGetVariableGenesMod(CPM_SC18_all_WT_expr, minBiolDisp = 0.1, fdr=0.01)
CPM_SC18_all_WT_expr_Brennecke <- BrenneckeGetVariableGenesMod(CPM_SC18_all_WT_expr, minBiolDisp = 0.1, fdr=0.01)
CPM_SC18_all_WT_expr_a0 <-CPM_SC18_all_WT_expr_Brennecke$A0
CPM_SC18_all_WT_expr_a1 <- CPM_SC18_all_WT_expr_Brennecke$A1
CPM_SC18_all_WT_expr_a1 <- CPM_SC18_all_WT_expr_Brennecke$A1
CPM_SC18_all_WT_expr_Brennecke_data <- CPM_SC18_all_WT_expr_Brennecke$data
CPM_SC18_all_WT_expr_HVG <- filter(CPM_SC18_all_WT_expr_Brennecke_data, q.value<0.01)
ggplot(CPM_SC18_all_WT_expr_Brennecke_data, aes(x=Mean, y=CV2)) +
geom_point() +
scale_x_log10() + scale_y_log10() +
xlab("Mean expression") +
ylab(bquote(CV^2)) +
geom_point(data=CPM_SC18_all_WT_expr_HVG,col="blue") +
geom_point(data=CPM_SC18_all_WT_expr_Brennecke_genes_interest, aes(col=type),  size=5) +
scale_color_brewer(palette = "Set2", name="Type of gene",
labels=expression("Nitrate assimilation",
"Nitrate transporters",
paste("Negative regulator of ", italic("NRT2.1")),
italic("NRT2.1"),
"NRT2.1 protein regulator",
paste("Positive regulator of ", italic("NRT2.1")))) +
theme_classic() +
theme(text = element_text(size = 20))
CPM_SC18_all_WT_expr_Brennecke <- BrenneckeGetVariableGenesMod(CPM_SC18_all_WT_expr, minBiolDisp = 0.1, fdr=0.01)
CPM_SC18_all_WT_expr_a0 <-CPM_SC18_all_WT_expr_Brennecke$A0
CPM_SC18_all_WT_expr_a1 <- CPM_SC18_all_WT_expr_Brennecke$A1
CPM_SC18_all_WT_expr_Brennecke_data <- CPM_SC18_all_WT_expr_Brennecke$data
CPM_SC18_all_WT_expr_HVG <- filter(CPM_SC18_all_WT_expr_Brennecke_data, q.value<0.01)
CPM_SC18_all_WT_expr_Brennecke_genes_interest <- inner_join(CPM_SC18_all_WT_expr_Brennecke_data, gene_types, by=c("Gene"="gene"))
ggplot(CPM_SC18_all_WT_expr_Brennecke_data, aes(x=Mean, y=CV2)) +
geom_point() +
scale_x_log10() + scale_y_log10() +
xlab("Mean expression") +
ylab(bquote(CV^2)) +
geom_point(data=CPM_SC18_all_WT_expr_HVG,col="blue") +
geom_point(data=CPM_SC18_all_WT_expr_Brennecke_genes_interest, aes(col=type),  size=5) +
scale_color_brewer(palette = "Set2", name="Type of gene",
labels=expression("Nitrate assimilation",
"Nitrate transporters",
paste("Negative regulator of ", italic("NRT2.1")),
italic("NRT2.1"),
"NRT2.1 protein regulator",
paste("Positive regulator of ", italic("NRT2.1")))) +
theme_classic() +
theme(text = element_text(size = 20))
ggplot(CPM_SC18_all_WT_expr_Brennecke_data, aes(x=Mean, y=CV2)) +
geom_point() +
scale_x_log10() + scale_y_log10() +
xlab("Mean expression") +
ylab(bquote(CV^2)) +
geom_point(data=CPM_SC18_all_WT_expr_HVG,col="blue") +
geom_point(data=CPM_SC18_all_WT_expr_Brennecke_genes_interest, aes(col=type),  size=5) +
scale_color_brewer(palette = "Set2", name="Type of gene",
labels=expression("Nitrate assimilation",
"Nitrate transporters",
paste("Negative regulator of ", italic("NRT2.1"), " transcription"),
italic("NRT2.1"),
"NRT2.1 protein regulator",
paste("Positive regulator of ", italic("NRT2.1"), " transcription"))) +
theme_classic() +
theme(text = element_text(size = 20))
CPM_SC18_all_WT_expr_Brennecke <- BrenneckeGetVariableGenesMod(CPM_SC18_all_WT_expr, minBiolDisp = 0.1, fdr=0.01)
CPM_SC18_all_WT_expr_a0 <-CPM_SC18_all_WT_expr_Brennecke$A0
CPM_SC18_all_WT_expr_a1 <- CPM_SC18_all_WT_expr_Brennecke$A1
CPM_SC18_all_WT_expr_Brennecke_data <- CPM_SC18_all_WT_expr_Brennecke$data
CPM_SC18_all_WT_expr_HVG <- filter(CPM_SC18_all_WT_expr_Brennecke_data, q.value<0.01)
CPM_SC18_all_WT_expr_Brennecke_genes_interest <- inner_join(CPM_SC18_all_WT_expr_Brennecke_data, gene_types, by=c("Gene"="gene"))
ggplot(CPM_SC18_all_WT_expr_Brennecke_data, aes(x=Mean, y=CV2)) +
geom_point() +
scale_x_log10() + scale_y_log10() +
xlab("Mean expression") +
ylab(bquote(CV^2)) +
geom_point(data=CPM_SC18_all_WT_expr_HVG,col="blue") +
geom_point(data=CPM_SC18_all_WT_expr_Brennecke_genes_interest, aes(col=type),  size=5) +
scale_color_brewer(palette = "Set2", name="Type of gene",
labels=expression("Nitrate assimilation",
"Nitrate transporters",
paste("Negative regulator of ", italic("NRT2.1"), " transcription"),
italic("NRT2.1"),
"NRT2.1 protein regulator",
paste("Positive regulator of ", italic("NRT2.1"), " transcription"))) +
theme_classic() +
theme(text = element_text(size = 20))
ggsave("Variability_graph_genes_nitrate_nutrition.jpg", width=11, height = 4)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
AR1277_plate1 <- read_tsv("AR1277_RTqPCR_luc_1mM_plate1.txt") %>%
mutate(expt="rep1" , plate="plate1")
AR1277_plate2 <- read_tsv("AR1277_RTqPCR_luc_1mM_plate2.txt") %>%
mutate(expt="rep1" , plate="plate2")
AR1277_plate3 <- read_tsv("AR1277_RTqPCR_luc_1mM_plate3.txt") %>%
mutate(expt="rep1" , plate="plate3")
AV32 <- read_tsv("AV32_20240319_RT_NRT21_vs_LUC.txt") %>%
mutate(expt="rep2" , plate="plate1")
SC73 <- read_tsv("20250808_SC73_RTqPCR.txt") %>%
mutate(expt="rep3" , plate="plate1")
RTqPCR_allPlates  <- bind_rows(AR1277_plate1, AR1277_plate2, AR1277_plate3, AV32, SC73)
library(ggtext)
group_by(RTqPCR_allPlates,expt, plate, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
select(-HVG, -LVG) %>%
rowwise() %>%
mutate(MeanControls=mean(c( UBQ10), na.rm = TRUE)) %>%
mutate_at(c( "LUC", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
ggplot(aes(x=LUC_PercControl, y=NRT2.1_PercControl)) +
geom_point(size=2.5) +
xlab(expression(atop(paste("Normalised expression for ",italic("LUC")), "measured by RT-qPCR"))) +
ylab(expression(atop(paste("Normalised expression for ",italic("NRT2.1")), "measured by RT-qPCR"))) +
stat_cor(size=6, col="gray40") +
facet_wrap(.~expt, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=18), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
ggsave("Correlation_NRT2.1_LUC_3reps.jpg", height = 4, width = 9.5)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
AR1277_plate1 <- read_tsv("AR1277_RTqPCR_luc_1mM_plate1.txt") %>%
mutate(expt="rep1" , plate="plate1")
AR1277_plate2 <- read_tsv("AR1277_RTqPCR_luc_1mM_plate2.txt") %>%
mutate(expt="rep1" , plate="plate2")
AR1277_plate3 <- read_tsv("AR1277_RTqPCR_luc_1mM_plate3.txt") %>%
mutate(expt="rep1" , plate="plate3")
AV32 <- read_tsv("AV32_20240319_RT_NRT21_vs_LUC.txt") %>%
mutate(expt="rep2" , plate="plate1")
SC73 <- read_tsv("20250808_SC73_RTqPCR.txt") %>%
mutate(expt="rep3" , plate="plate1")
RTqPCR_allPlates  <- bind_rows(AR1277_plate1, AR1277_plate2, AR1277_plate3, AV32, SC73)
library(ggtext)
group_by(RTqPCR_allPlates,expt, plate, Primer, Name) %>%
summarise(MeanCp=mean(Cp, na.rm = TRUE)) %>%
pivot_wider(names_from = Primer, values_from = MeanCp) %>%
select(-HVG, -LVG) %>%
rowwise() %>%
mutate(MeanControls=mean(c( UBQ10), na.rm = TRUE)) %>%
mutate_at(c( "LUC", "NRT2.1"), funs(PercControl=(2^(-(.-MeanControls))*100))) %>%
ggplot(aes(x=LUC_PercControl, y=NRT2.1_PercControl)) +
geom_point(size=2.5) +
xlab(expression(paste("Normalised expression for ",italic("LUC"), "measured by RT-qPCR"))) +
ylab(expression(atop(paste("Normalised expression for ",italic("NRT2.1")), "measured by RT-qPCR"))) +
stat_cor(size=6, col="gray40") +
facet_wrap(.~expt, scales = "free") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=18), axis.title=element_text(size=16),
plot.title = element_text(size=20,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
ggsave("Correlation_NRT2.1_LUC_3reps.jpg", height = 3.8, width = 9.5)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(RColorBrewer)
Inlux_luc_1mM_AR1282 <- read_tsv("AR1282_1mM_10mM_KNO3/AR1282_influx_luciferase.txt") %>%
filter(KNO3=="1mM") %>%
mutate(expr="AR1282")
Inlux_luc_1mM_AV14 <- read_tsv("AV14_1mM_KNO3/AV14_influx_luciferase.txt")  %>%
mutate(expr="AV14")
Inlux_luc_1mM_AV15 <- read_tsv("AV15_1mM_KNO3/AV15_influx_luciferase.txt")  %>%
mutate(expr="AV15")
Inlux_luc_1mM_AV26 <- read_tsv("AV26_1mM_KNO3/AV26_influx_luciferase.txt")  %>%
mutate(expr="AV26")
Inlux_luc_1mM_SC21 <- read_tsv("SC21_1mM_KNO3/SC21_influx_luciferase.txt")  %>%
mutate(expr="SC21")
Inlux_luc_1mM_all <- bind_rows(Inlux_luc_1mM_AR1282, Inlux_luc_1mM_AV14, Inlux_luc_1mM_AV15,
Inlux_luc_1mM_AV26,Inlux_luc_1mM_SC21)
ggplot(Inlux_luc_1mM_all, aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=expr)) +
geom_point(size=3) +
stat_cor(method="spearman", size=4.8) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
ggtitle(bquote('Seedlings grown with 1mM KNO'[3])) +
scale_color_brewer(palette = "Dark2") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
ggsave("Ninflux_1mM_WT_5reps.jpg", width=5.3, height = 4.4)
Inlux_luc_1mM_all <- bind_rows(Inlux_luc_1mM_AR1282, Inlux_luc_1mM_AV14, Inlux_luc_1mM_AV15,
Inlux_luc_1mM_AV26,Inlux_luc_1mM_SC21)
ggplot(Inlux_luc_1mM_all, aes(x=Ninflux_umoleN_Gms_heure, y=RawIntDen_normBackg_normLen, col=expr)) +
geom_point(size=3) +
stat_cor(method="spearman", size=4.8) +
xlab(bquote('Nitrate influx ('*mu*'mol ' ^15*'N/gDW/h)')) +
ylab(expression(paste("Luciferase signal for ", italic("pNRT2.1:LUC")))) +
ggtitle(bquote('Seedlings grown with 1mM KNO'[3])) +
scale_color_brewer(palette = "Dark2") +
theme(legend.text=element_text(size=16),legend.title = element_text(size=16, face="bold"),
axis.text=element_text(size=16), axis.title=element_text(size=16),
plot.title = element_text(size=19,face="bold"),
panel.background = element_rect(fill = "white", colour = "grey50"),
legend.position = "none", strip.text.x = element_text(size = 18))
ggsave("Ninflux_1mM_WT_5reps.jpg", width=5.3, height = 4.5)
